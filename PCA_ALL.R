#------------------------------------------#
#              Walleye Project             #
#------------------------------------------#

setwd("C:/Users/user/Dropbox/PC/Desktop/Regression")

#### 2018 Metabolite Only PCA ####
#### set up ####
getwd()
setwd("C:/Users/user/Dropbox/PC/Desktop/Regression")

options(stringsAsFactors = FALSE) #prevent character data from being read as factor data

ls()
rm(list = ls())

options(max.print=1000000)

#### load packages ####

library(tidyverse)
library(corrplot)
library(FactoMineR)
library(factoextra)
library(sjstats)
library(performance)
library(forestmodel)
library(emmeans)
library(pwr)


#### Read in data total ####

# read data

MET_FM_ALL<- read.csv("C:/Users/user/Dropbox/PC/Desktop/Regression/2018_MET_FM.csv", quote="")
View(MET_FM_ALL)
names(MET_FM_ALL)
str(MET_FM_ALL)
MET_FM_ALL <- read.csv("C:/Users/user/Dropbox/PC/Desktop/Regression/Metabolites_All.csv", quote="")
#Warning messages:

# load in object with met_groups
# met_groups <- readxl::read_excel("Class_2018.xlsx") %>% 
#   print()
# met_groups <- met_groups[-1,]
# Read in the same raw data in Excel format like Matt the whole mettabolites
raw_data <- readxl::read_excel("Metabolites_NMR_MS_ALL_2018.xlsx") %>% 
  mutate(Sex = na_if(Sex, "NA"), Spine_Age = na_if(Spine_Age, "NA")) %>% 
  mutate(Sex = as.factor(Sex), Site = as.factor(Site), Mortality = as.factor(Mortality), ) # did not work for me
names(MET_FM_ALL)

# as data.frame
DM_data.frame <- data.frame(MET_FM_ALL)
names(DM_data.frame)
dim(DM_data.frame)
# 122 165

# dataframe with just met data columns
DM_data_pca <- DM_data.frame[, c(9:165)] %>%
  print()

dim(DM_data_pca) 
#122 157

# load in object with met_groups
met_groups <- readxl::read_excel("Metabolite_groups_18.xlsx") %>% 
  print()

summary(DM_data_pca)


#### Correlations plot ####

DM_cor <- cor(DM_data_pca)

summary(DM_cor)

corrplot(DM_cor, type = "upper", order = "hclust", 
         tl.col = "black", tl.srt = 60, 
         tl.cex = 1, cl.cex = 1)
dev.off()


#### PCA ####

# PCA with FactoMineR package

DM_pca_FM <- PCA(DM_data_pca, graph = FALSE)


#### Eigenvalues / Variances ####

# extract eigenvalues/varianes
get_eig(DM_pca_FM)
# 94     17.300  104.0                        58.0      15.80     48.5    7.1775   11645  147.5625
# 95     11.200   96.8                        48.0      18.60     52.3    6.6700    5594  187.0625
# 96     10.600   58.3                        44.0      11.60     35.0    4.7875    4351  109.2500
# 97     21.500   66.9                        30.0      19.70     53.4    4.7675    4686   86.6875
# 98     13.100   94.8                        56.0      13.80     40.3    8.7500    8534  202.5000
# 99     11.600   92.7                        38.0      13.10     53.5    8.3125    3538  194.1875
# 100     5.440  100.0                        69.0      14.60     42.5    5.0850    6863  206.5625
# 101    10.900   96.4                        30.0      18.10     46.5    8.1875    6088  111.4375
# 102    16.600  148.0                        49.0      20.00     47.5    9.9125    6088  116.8125
# 103     5.240   76.3                        30.0       6.63     29.5    9.1575    4239  168.6875
# 104     5.810   90.8                        37.0      11.20     60.4    8.9300    8299  111.6875
# 105     5.740  103.0                        62.0      15.60     39.5    7.7725    8384  106.1500
# 106    10.500   58.8                        53.0      12.30     58.9   12.8500    9032   71.2000
# 107     5.090   94.3                        43.0      13.70     34.2    7.6675    7632  106.5500
# 108    21.400  107.0                        30.0      20.10     52.5   11.0375    6887  190.5000
# 109    16.900   93.2                        25.0      32.50     82.7    7.3475    5656  158.6250
# 110    25.600  138.0                       101.0      25.30     60.8   10.1875    6081  151.1250
# 111    20.100  108.0                        25.0      39.00     81.9   10.0500    6136  167.0000
# 112    29.200   76.3                        36.0      61.00     76.3   13.0250    7884  105.1875
# 113     7.920   77.2                        51.0      11.10     36.1   12.9500    8679   69.1625
# 114    21.800   96.3                        21.0      29.00     65.9    8.2025    7359  167.6875
# 115     8.760   59.2                        67.0      15.00     48.8    6.5425    5215   93.6500
# 116    30.900   77.7                        34.0      18.30     76.0   11.3625    6269   67.1500
# 117    28.500   94.1                        16.0      15.20     46.1   11.8375    5557  213.5625
# 118    13.000   68.4                        30.0      24.90     68.7   11.3625    9524   58.4875
# 119    19.800   50.9                        30.0       5.88     37.8    9.9125    3769   64.1875
# 120    13.200   72.5                        49.0      34.90     52.6    9.9500    5676  115.6875
# 121    23.200   87.4                        46.0      16.60     51.7   19.3250    7603  100.0000
# 122    40.000  182.0                        82.0      17.50     39.2   10.7500    5912  185.3750
# Total.Dimethylarginine Threonine.1 Malate Malonate Mannose Methanol Methionine Methionine.Sulfoxide
# 1                    1.800    173.9375   53.1     45.3    55.4     56.4   62.40000                0.789
# 2                    1.340    159.3750   76.6     70.5    46.1     54.6   69.01250                1.440
# 3                    0.901    142.8750   32.6     51.0    46.1     37.3   67.45000                1.040
# 4                    0.978    193.5625   93.8     42.1    46.1     52.0   77.17500                1.280
# 5                    2.410    183.0625   55.5     96.4    46.1     44.0   73.41250                1.070
# 6                    1.210    118.1625   72.6    171.9    48.1     83.3   57.22500                2.800
# 7                    1.520    167.4375   70.8     73.9    71.5     49.1  102.38750                1.660
# 8                    0.959    169.5625   93.8     65.1    47.4     52.0   60.68750                1.000
# 9                    1.570    246.4375  138.1     76.3    49.9     43.1   72.56250                1.510
# 10                   1.840    152.3571   75.7    136.6    38.6    247.0  101.58571                2.210
# 11                   1.510    166.9375   93.8     79.4    46.6     55.9   74.97500                1.700
# 12                   1.770    139.5625   83.9    116.8    49.1     72.1   60.93750                1.470
# 13                   0.762    151.8250   92.0     53.5    61.0     55.4   52.25000                1.050
# 14                   1.760    200.0000  145.4     73.1    47.3     41.6   75.76250                1.070
# 15                   1.420    221.3125  111.1     68.5    59.0     53.4   56.58750                0.649
# 16                   1.960    148.4167   99.3     71.2    44.7     66.5   69.36667                1.140
# 17                   0.743    143.8125   72.0     70.4    40.4     52.0   44.33750                0.806
# 18                   2.260    200.6429  102.9    199.0    59.1     96.0   77.87143                1.110
# 19                   1.970     99.6375   53.5     95.8    41.5     57.6   35.70000                0.760
# 20                   2.020    129.2625   66.9     80.5    46.1     73.1   28.92500                0.843
# 21                   1.380    115.9250   63.4     94.0    62.6     55.9   46.73750                1.270
# 22                   1.970    120.1250   78.3     74.1    71.1    172.8   49.12500                1.410
# 23                   1.290    127.4875   93.8     53.1    71.9     42.6   50.37500                0.578
# 24                   1.240    107.1250   51.1     66.0    37.3     58.1   37.56250                0.758
# 25                   1.640    141.3571   56.3     74.7    48.6     55.7   31.83571                1.490
# 26                   0.993    141.0500   51.8     44.0    58.8     64.0   26.33750                0.560
# 27                   1.830    199.1875  112.3     93.3    90.8     77.3  117.12500               10.200
# 28                   2.590    108.1750   47.0     56.9   103.6     81.1   48.02500                1.330
# 29                   1.260     80.9125   24.1     48.9    64.1     87.6   30.95000                1.690
# 30                   1.880    191.5625  115.9    107.4    55.0     52.0  108.12500               13.300
# 31                   2.210    168.5625   75.3     74.5    57.3     49.5   45.30000                1.160
# 32                   1.580    233.1875   73.4    105.8    65.0     59.3   63.33750                1.330
# 33                   1.720    142.7500   76.8     84.8    48.9     58.3   42.82500                0.714
# 34                   1.010    150.8125   48.4     85.6    49.0     71.8   40.56250                0.967
# 35                   2.060    117.2500   37.6    154.1    42.6     92.9   39.92500                1.000
# 36                   1.590    134.2500   78.8     62.9    58.8     74.5   64.85000                4.470
# 37                   1.900     76.4625   34.5     72.6    77.8     74.3   42.87500                2.030
# 38                   1.140    233.8125   48.9     58.5    67.4     50.3   64.86250                1.150
# 39                   0.988    159.7500   65.0     51.5    49.1     52.0   52.40000                1.060
# 40                   0.855    165.6875   48.0    136.0    39.8     97.4   39.71250                3.510
# 41                   1.200    221.0625   50.1    176.4    43.5    116.3   87.43750                4.120
# 42                   2.450    181.9375   91.4    101.3    56.9     41.5  110.12500                4.530
# 43                   2.710    211.6875   51.8     62.0    72.9     51.3   97.43750                3.430
# 44                   2.570    204.0000   70.4     77.3    53.5     69.8  139.50000                4.620
# 45                   1.890    181.7500   75.1     69.3    47.5     49.0   69.63750                6.400
# 46                   1.710    300.8750   76.0     94.9    51.5     48.4  128.46250                3.630
# 47                   1.380    129.2500   46.1     38.4    38.1     36.9   41.25000                1.120
# 48                   1.570    180.4375   61.9    108.8    50.0    111.5   98.26250                3.340
# 49                   1.380    204.5625   47.8    239.0    37.6     84.9   68.86250                3.420
# 50                   2.340    189.0625   77.6     70.6    62.4     52.0  156.56250                5.520
# 51                   3.530    215.1250  102.0    132.8    46.1     48.9  110.12500                3.950
# 52                   3.470    258.1875  167.8    140.0    54.8     57.0  138.75000               12.900
# 53                   1.630    123.3375   59.5    180.9    49.1    153.6  102.06250                3.090
# 54                   2.270    187.0625   68.3     97.1    82.1     40.8  102.92500                2.980
# 55                   2.220    153.8750   41.4     65.9    77.5     82.3   50.52500                1.950
# 56                   1.900    113.8125   53.6     68.1    73.1     75.3   71.41250                3.220
# 57                   1.340    145.0000   46.6     94.4    49.6    175.9   55.83750                1.330
# 58                   2.490    141.0000   55.4    109.4   101.9    167.0   77.40000                3.650
# 59                   2.350    217.2143   54.3    152.1    60.7     70.7   68.25000                1.830
# 60                   1.850    199.0625   49.0    101.1    79.5     61.4   41.03750                1.370
# 61                   3.560     99.2250   54.5    110.8    80.5     85.9   45.27500                0.897
# 62                   1.220     74.5625   86.8     83.1    60.8     61.4   51.17500                1.300
# 63                   1.870    270.5625    8.8     63.9    37.3    131.0   76.46250               17.700
# 64                   0.398     50.9125    8.8     66.0    11.5    125.0   14.01250                5.370
# 65                   0.434     58.8125    8.8     58.8    13.0    116.0   13.88750                5.260
# 66                   0.739     66.4125    8.8     43.0    50.8    120.0   24.02500                9.480
# 67                   2.470    243.7500    8.8     40.1    37.3    122.0   69.16250               15.000
# 68                   1.400    195.0625   53.6     45.3    61.3    131.0   57.16250               17.600
# 69                   0.951    153.7500    8.8     29.6    18.9    122.0   34.76250               11.400
# 70                   1.780    216.8750   27.5     32.1    29.1    131.0   59.47500               13.100
# 71                   1.180     91.4500   69.1     37.4    50.0    126.0   33.73750                9.480
# 72                   1.010    143.0625  102.9     60.8    22.5    126.0   29.65000               11.400
# 73                   0.991     85.9375    3.1     27.4    25.8    117.0   26.53750                6.380
# 74                   0.305     33.2250    8.8     55.0    10.8    123.0    7.25500                3.730
# 75                   0.532     70.1750    3.1     24.8     6.1    104.0   17.05000                8.760
# 76                   0.274     37.2750    8.8     37.5    11.3    111.0   18.52500                9.460
# 77                   0.280     37.3625   13.3     66.5    19.4    132.0    9.95000                3.860
# 78                   1.250     95.4750    8.8     28.3    26.1    118.0   28.52500                8.590
# 79                   0.354     31.8625   19.0     27.9     6.6    128.0    5.81750                2.870
# 80                   0.547     42.8875    9.4     32.1     3.3    110.0    6.87750                3.150
# 81                   0.263     23.2750    9.4     28.3     7.4    114.0    3.79500                1.030
# 82                   0.607     58.2625    8.8     14.0     7.9    111.0    6.83500                3.050
# 83                   0.917    109.7500    8.1     17.0    15.9    199.0   30.97500               11.300
# 84                   1.230    123.5625    7.0     37.5    33.0    216.0   55.11250               17.600
# 85                   1.090    143.0625    6.3     30.8    12.5    131.0   43.80000               12.400
# 86                   1.100     90.4750    8.1     46.0    26.5    213.0   26.81250                9.160
# 87                   0.600     49.7750    8.1     36.6    26.5    217.0   10.46250                4.810
# 88                   0.682     78.6500    8.1     45.5    21.1    217.0   17.38750               10.500
# 89                   0.938     63.0375    9.4     35.5    38.5    211.0   19.05000                4.980
# 90                   0.818     59.1625    1.9     12.3    17.3    191.0   25.51250                8.390
# 91                   0.881     79.5000    9.4     38.3    32.3    223.0   17.73750                5.360
# 92                   1.520    138.6250    9.4     39.8    32.6    214.0   84.52500               20.600
# 93                   1.220    111.1875   15.9     41.3    44.8    211.0   20.76250                4.890
# 94                   0.792    147.5625   11.9     64.4    36.5    225.0   27.85000                7.990
# 95                   1.190    187.0625    9.4     25.1    16.9    210.0   27.18750                6.730
# 96                   0.850    109.2500    9.4     25.4    19.0    210.0   11.98750                6.860
# 97                   0.925     86.6875    9.4     35.5    38.5    208.0   15.23750                6.050
# 98                   0.872    202.5000   18.8     47.0    17.3    205.0   27.75000                9.080
# 99                   1.130    194.1875    9.4     54.5    38.5    203.0   26.12500                7.190
# 100                  0.944    206.5625   36.3     31.4    29.5    218.0   27.11250                6.900
# 101                  1.940    111.4375   16.1     63.1    23.1    205.0   30.70000                8.780
# 102                  1.290    116.8125   28.6     35.3    28.0    212.0   21.47500                6.940
# 103                  0.797    168.6875   16.1     35.5    38.5    153.0   12.82500                8.620
# 104                  0.973    111.6875   20.6     45.3    24.3    144.0   28.26250                6.330
# 105                  1.030    106.1500   16.5     53.1    21.3    152.0   23.15000                7.270
# 106                  1.180     71.2000    9.9     71.9    39.1    141.0   22.62500                5.890
# 107                  1.310    106.5500    9.4     34.6    32.8    154.0   20.22500                9.980
# 108                  1.880    190.5000   11.6     42.0    38.5    152.0   61.91250               16.200
# 109                  1.310    158.6250    9.4     29.0    24.1    148.0   43.23750               12.500
# 110                  1.970    151.1250    8.1     26.9    21.1    140.0   29.57500               13.800
# 111                  2.360    167.0000    9.4     56.8    11.9    139.0   24.33750                4.090
# 112                  1.600    105.1875   19.5     59.3    36.5    168.0   28.75000                9.340
# 113                  1.090     69.1625   20.4     44.8    38.9    142.0   29.10000                6.370
# 114                  1.650    167.6875   55.6     38.9    15.5    141.0   49.00000                6.840
# 115                  0.880     93.6500    9.4     27.6    27.4    143.0   22.38750                3.240
# 116                  1.740     67.1500    9.4     39.5    25.9    129.0   31.55000                7.710
# 117                  1.230    213.5625    9.4     40.6    24.5    145.0   23.10000               11.800
# 118                  1.400     58.4875    9.4     66.6    14.0    152.0   30.22500                4.740
# 119                  0.884     64.1875   13.6     35.5    38.5    211.0   18.90000                6.240
# 120                  1.720    115.6875    9.4     57.9    38.5    131.0   21.30000                5.680
# 121                  3.290    100.0000   35.1     45.5    37.4    149.0   52.00000               10.800
# 122                  1.730    185.3750    8.1     92.4    36.9    165.0   60.21250               20.900
# Methylhistidine N_N_Dimethylglycine Nicotinurate O.Acetylcarnitine O.Phosphocholine Ornithine
# 1             91.30                47.0         41.5              22.4             70.6  21.10000
# 2             78.40                72.4         37.9              51.3             84.8  14.97500
# 3             55.40                28.0         30.8              31.0             49.8  31.38750
# 4             83.90                44.4         23.1              13.1             70.6  15.12500
# 5             90.70                44.9         29.8              21.6             59.0  33.18750
# 6            169.00                28.4         31.8              15.4             70.6  28.90000
# 7             84.00                65.0         57.3              33.0             80.3  15.62500
# 8             75.50                62.5         37.6              53.8             70.6  21.82500
# 9             59.00                43.3         29.8              12.3             69.0  30.35000
# 10           294.00                29.3         54.7              31.9             91.6  27.12143
# 11           123.00                41.1         43.9              19.0             70.6  17.45000
# 12           206.00                81.3         53.6              19.8             82.3  21.07500
# 13            72.20                37.9         37.8              22.0             62.4  32.47500
# 14            83.90                55.3         47.9              54.6             70.6  17.13750
# 15            64.40                51.5         38.5              45.9             73.1  12.93750
# 16            72.70                74.0         53.5              34.7             68.5  24.48333
# 17            30.60                48.0         40.4              11.4             51.8  17.67500
# 18           179.00                70.6         57.3              44.6             91.3  39.76429
# 19           153.00                44.5         40.3              54.0             84.4  19.58750
# 20            86.80                63.9         27.9              79.4             75.3  20.75250
# 21           197.00                36.5         23.1              27.3             48.4  22.12500
# 22           109.00                26.8         34.1              30.5             62.5  30.03250
# 23            78.40                42.1         55.4              37.1             87.9  22.26250
# 24           132.00                41.0         35.1              49.3             99.5  28.98750
# 25           125.00                39.1         24.6              58.9             94.7  37.76786
# 26            92.00                60.9         22.5              32.3             70.6  26.75250
# 27            78.50                20.5         27.3              24.9             81.8  27.10000
# 28            91.70                22.3         36.9              24.1             70.6  41.76250
# 29            92.60                42.3         40.1              27.0             70.6  19.57500
# 30           194.00                47.9         35.5              29.9             87.6  16.77500
# 31            67.10                84.5         43.0              64.0             92.1  25.96250
# 32            74.00               120.1         51.5              45.8             80.3  30.35000
# 33           126.00                68.4         41.3              52.6            102.0  26.30000
# 34           146.00                41.4         30.8              73.4             84.4  27.35000
# 35            22.50               100.9         46.4              88.1            119.1  48.12500
# 36            62.50                11.9         37.4              15.3             79.1  20.79500
# 37            65.50                80.3         28.8              28.0             77.6  30.43750
# 38           226.00                21.1         72.5              22.6            103.5  39.48750
# 39           120.00                27.9         43.1              57.6             74.0  25.86750
# 40            71.60                32.1         19.6              46.3             64.8  20.63000
# 41            45.70                42.3         27.8              68.3            136.9  33.55000
# 42            83.40                19.5         53.3              24.3             87.4  31.35000
# 43            32.20                11.1         45.6              17.1             90.9  29.07500
# 44            23.90                20.3         71.3              15.1            119.4  25.45000
# 45            59.90                25.6         36.8              24.1             70.6  16.17500
# 46            30.70                16.1         35.3              17.0            104.5  81.43750
# 47            74.30                38.0         23.6              11.1             58.6  16.96250
# 48            28.00                28.3         52.0              21.4            101.6  16.12500
# 49            64.30                33.4         29.3              23.8             85.6  28.29250
# 50            64.20                37.3         37.9              11.5             77.9  29.37500
# 51            55.90                32.4         41.6              16.3            128.6  60.08750
# 52            36.40                27.4         38.5              22.1             98.3  36.98750
# 53            50.90                29.5         32.8              34.6             92.1  26.97500
# 54            30.80                12.4         30.9              13.1             71.1  39.28750
# 55            31.00                13.4         60.5              17.0             63.3  26.66000
# 56            42.00                12.8         32.3              17.1             72.6  26.69750
# 57             8.45                41.9         42.0              36.1             61.0  19.38000
# 58            48.50                22.3         44.5              22.1             97.1  45.01250
# 59            52.50                37.7         49.9              21.9             87.9  36.55786
# 60            97.20                21.5         42.5              35.6             70.6  22.10000
# 61           240.00                36.0         31.0              20.8             49.5  39.87500
# 62            70.90                28.6         31.5              17.4             50.4  25.28000
# 63            24.10                29.9         29.6              24.3             50.3  19.20000
# 64            37.30                29.1         27.5              20.1             50.3   0.37800
# 65             7.00                28.4         22.9              13.3             43.6   0.00000
# 66            40.30                29.9         27.9              21.6             33.0   9.62000
# 67            31.70                29.9         29.6              16.6             50.3  29.50000
# 68            23.40                27.5         43.5              26.5             50.3  23.90000
# 69            41.00                15.3         31.4              15.4             50.3   8.16000
# 70            33.50                24.9         37.3              20.3             50.3  23.60000
# 71            19.00                43.8         52.1              11.4             37.5  10.30000
# 72            21.10                41.8         41.9              20.9             58.4   4.03000
# 73            81.40                23.0         30.0              17.6             49.4   5.90000
# 74             8.01                28.8         32.9              10.3             45.6   0.00000
# 75            14.30                16.9         16.9              13.0             27.0   2.18000
# 76             6.09                23.4         12.0               9.4             28.4   3.08000
# 77            21.60                12.0         34.0               6.3             43.9   2.50000
# 78            19.20                11.4         40.1              11.6             43.4  14.30000
# 79             3.55                21.3         34.0               6.4             35.3   0.00000
# 80             7.74                24.3         15.4              14.6             28.4   1.10000
# 81            17.30                14.6         11.6               3.1             41.9   0.00000
# 82             5.64                13.0          5.3              14.3             15.5   0.00000
# 83            32.90                25.3         12.1               7.3             18.1  23.00000
# 84            42.70                32.6         31.6              10.3             49.1  18.40000
# 85             5.66                32.1         27.8               8.1             41.5   5.12000
# 86            14.00                 9.6         27.8               5.8             44.5   7.04000
# 87            14.80                 9.6         27.8               9.8             44.5   0.66400
# 88             8.96                30.9         28.1              10.0             76.4   4.46000
# 89            48.10                21.5         14.1              10.0             41.9   0.75500
# 90            22.30                 6.6         10.8              14.3             13.9   4.73000
# 91            30.00                35.9         18.8              33.9             52.6   2.12000
# 92            83.20                24.6         14.5              23.0             64.8   6.67000
# 93            15.90                23.8         18.1               9.8             54.5   0.83900
# 94             4.45                35.9         17.9              21.3             45.8   4.58000
# 95             8.93                13.1         17.0              20.3             49.8   4.10000
# 96             5.99                10.3         16.1              13.3             31.4   4.80000
# 97             4.67                17.3         14.1              23.0             23.8   3.95000
# 98             8.06                25.8         28.3              11.3             58.3   8.03000
# 99             7.61                12.4         14.5              28.4             25.0   6.94000
# 100            9.62                37.5         25.3              13.0             43.4   4.46000
# 101           85.80                26.5         14.1              29.1             37.6   5.72000
# 102           32.60                20.3         21.0              27.1             43.0   5.01000
# 103            5.87                21.5         14.1              32.4             26.1   0.00000
# 104           49.00                48.1         16.6              31.0             41.9   6.13000
# 105           60.70                16.1         31.4              18.3             56.6   2.25000
# 106            2.38                34.1         20.1              14.4             61.4   1.41000
# 107           36.70                45.3         23.6              33.0             54.4   2.17000
# 108            8.62                23.3         40.3              13.1             53.5   5.44000
# 109           16.40                18.1         32.3              16.4             36.4   8.25000
# 110            6.24                26.5         33.1              17.9             40.5   1.57000
# 111            9.14                20.0         41.4              33.0             26.1   3.59000
# 112           10.60                13.3         47.0              12.9             72.0   7.59000
# 113            3.84                37.3         46.5              18.1             49.1   4.39000
# 114            8.11                16.0         47.6              15.0             47.9   2.60000
# 115           38.90                16.4         26.0               6.4             44.0   0.63300
# 116            5.05                 7.1         26.5              13.0             72.3   4.57000
# 117           13.30                21.5         29.4               5.3             50.9   0.77100
# 118            6.94                14.3         48.3              11.8             64.4   1.02000
# 119            4.27                21.5         14.1              16.8             30.9   0.00000
# 120            9.44                 8.3         33.9              18.4             57.8   3.80000
# 121            7.45                10.4         35.9              13.0             67.6   1.96000
# 122           21.60                 8.4         31.0              10.3             64.6   1.57000
# Trans.Hydroxyproline Tryptophan  Tyrosine Uridine Xanthine   Valine X1.Methylhistidine
# 1                  2.320      18.60  88.68750    14.9   19.100 173.8125              24.90
# 2                  0.786      21.60 113.62500    18.8   11.500 189.3750              36.00
# 3                  6.360      15.30  60.26250    11.1   22.600 136.7500               9.80
# 4                  0.765      15.30  66.68750    14.3   19.000 159.1875              11.80
# 5                 11.000      15.30  71.52500    10.5   26.300 156.1875              39.90
# 6                  1.380      20.80  69.98750    15.3   32.800 165.3125              50.30
# 7                  1.110      14.40  85.00000    17.1   29.000 172.0000              24.30
# 8                  0.930      10.50 110.12500    18.9   22.300 125.4375              30.10
# 9                  2.040      20.60  81.25000    30.6   10.100 229.0625              22.40
# 10                 1.400      24.30 110.68571    14.3   29.400 293.7143              95.10
# 11                 1.280      18.30  99.86250    14.5   22.500 170.0625              37.10
# 12                 0.475      17.50  73.08750    20.0   41.900 159.6875              42.00
# 13                 1.920      19.60  74.01250    16.3   28.000 182.0000              10.90
# 14                 1.130      26.90 108.62500    11.6   69.500 186.0625              15.80
# 15                 2.020      18.10  84.93750    22.9   42.000 170.2500               9.60
# 16                 1.180      29.00 101.50000    19.0   38.300 215.8333              21.80
# 17                 1.080      16.90  58.56250    14.9    8.900 110.8125               7.50
# 18                 1.240      21.60  76.46429    15.9   25.900 278.2143             127.30
# 19                 2.230      12.00  63.02500    20.5    9.000 132.5000              29.50
# 20                 1.810       8.40  47.42500    25.8   20.900 140.4500               8.80
# 21                 3.650      15.30  60.73750    13.9   14.600 143.5000              45.80
# 22                 3.240      10.00  56.87500    13.6   25.000 151.0000              52.50
# 23                 1.270      16.30  48.43750    25.8    9.600 178.8125              27.60
# 24                 2.540      14.10  67.90000    21.4   16.900 108.2500              23.90
# 25                 1.150      14.90  51.74286    22.6   21.600 120.4143              58.10
# 26                 2.160      17.60  50.05000    16.8    8.300 128.6250              12.50
# 27               132.000      26.10 104.50000    18.1    9.600 480.0625              27.10
# 28                 2.320      20.40  73.75000     9.6   14.000 180.3750               9.00
# 29                15.600      15.30  48.11250    26.8   20.400 185.4375              22.10
# 30               104.000      32.40 181.31250    12.3   20.300 543.0000              43.30
# 31                 6.460      16.40  93.12500    22.5   16.600 195.1250               9.40
# 32                31.200      26.30  58.80000    18.3   11.400 201.8750              15.40
# 33                 1.290      13.00  65.93750    14.3   23.800 194.8125              54.80
# 34                 2.580      15.30  70.73750    21.1   19.300 149.9375              39.90
# 35                 4.270      14.60  64.91250    25.6   21.300 133.6875              10.50
# 36               111.000      35.30  99.86250    20.5   16.900 724.6875              18.30
# 37                 0.844      15.30  43.35000    16.5    8.100 130.2500               4.40
# 38                46.200      33.50  76.56250    16.8   30.800 534.0625              34.00
# 39                17.900      24.10 128.18750    18.8   13.300 274.0000              19.60
# 40                12.300       8.90  50.55000    12.5   13.800 104.6250              22.10
# 41                38.000      23.00 116.00000    23.4   11.600 294.7500              14.90
# 42               108.000      38.30 157.50000    14.0   16.800 700.6250              19.80
# 43                59.100      37.00 150.43750    16.6   17.500 623.7500               7.90
# 44                93.600      37.60 198.81250    16.4    4.600 559.1250               5.00
# 45                69.300      11.00  53.61250    15.0   15.300 207.8750              15.60
# 46                74.900      41.50 147.86250    20.5   14.000 748.8125              20.50
# 47                16.300      18.50  68.17500    10.5   15.500 128.6250              12.50
# 48                31.800      27.40  73.53750    30.6   24.100 309.0625              21.90
# 49                79.700      15.30  76.38750    29.0   19.800 302.1250              18.10
# 50               132.000      24.90 114.37500    16.4   19.100 373.5625              38.40
# 51               105.000      48.30 227.06250    25.6   19.100 820.6875              12.50
# 52               136.000      39.50 187.31250    19.3   23.900 654.8125              35.10
# 53                83.600      22.90  85.92500    24.6   23.400 257.8125               8.90
# 54                81.600      36.60 127.43750    17.6   17.100 775.7500               7.10
# 55                50.600      20.60  75.91250    21.6   13.500 466.6875              10.80
# 56                63.900      28.50  69.58750    15.9   17.600 388.0000              24.30
# 57                 7.170      18.80  89.78750    26.5   22.600 216.2500               4.40
# 58                67.500      28.90 100.87500    26.8   18.100 826.1875              16.30
# 59                19.100      24.90  75.37143    31.6   15.700 196.4286              13.00
# 60                12.000      23.50  61.28750    16.9   15.600 156.6875              16.40
# 61                19.800      16.50  65.16250    12.9    6.300 131.1875              90.00
# 62                13.200      23.10  54.96250    18.3   17.100 155.1875              21.30
# 63                 1.240      24.40 178.31250    19.9    0.000 190.8125               7.13
# 64                 3.780      14.10  31.38750    14.5    0.000  66.5125               8.75
# 65                 2.050      17.40  49.06250    14.3    0.000  82.4375               8.13
# 66                 0.604      14.00  50.88750    16.0    0.000 135.6875               7.38
# 67                 1.170      33.90 178.31250    19.9    0.000 297.0000              11.88
# 68                 1.100      20.50  88.41250    20.6    0.000 176.8125               7.13
# 69                 1.910      23.00  88.13750    21.3    1.000 129.5625               6.25
# 70                 1.180      21.20 101.56250    27.3    0.000 168.8125               5.63
# 71                 1.040      17.80  60.07500    30.9    0.000 133.1250               7.50
# 72                 1.390      18.70  59.90000    26.6    0.000 162.0000               8.00
# 73                 0.600      13.30  41.32500    12.0    0.000 102.1875               6.25
# 74                 5.380       8.85  20.71250    13.5    0.000  50.5875               6.38
# 75                 1.270      17.90  43.42500     9.8    0.000  91.4750               5.88
# 76                 0.567      15.00  47.86250    10.8    0.000  80.0500               6.50
# 77                 1.030       7.82  19.92500     8.9    1.750  53.7000               6.13
# 78                 0.743      14.70  48.06250    24.1    0.000 182.6875               6.88
# 79                 4.610       7.46  18.12500     9.9    0.875  55.2375               5.63
# 80                 0.531      11.00  23.96250     9.3    0.750  57.3125               7.88
# 81                 1.080       5.98  10.13500     7.8    1.500  49.9875              10.75
# 82                 3.320      12.30  19.18750     4.1    0.000  81.1125               6.00
# 83                 1.130      13.50  44.20000    10.6    1.125 156.8125               6.50
# 84                 0.242      14.00  57.27500    21.9    0.000 207.3125               7.13
# 85                26.200      17.80  41.51250    17.3    1.875 225.3125               7.13
# 86                 3.340      15.40  43.60000    17.3    1.750 123.2500               6.88
# 87                 0.945      10.30  22.65000    17.3    1.375  77.2250               6.88
# 88                 7.580       9.62  33.68750    26.0    1.750 100.6375               6.38
# 89                 1.430       9.19  38.11250    11.0    1.375  88.9500               7.25
# 90                 1.180      11.10  28.60000     6.6    1.375  99.1875               3.88
# 91                 1.320       5.22  45.06250    20.6    1.125 125.6250               6.13
# 92                66.300      26.20  56.02500    17.6    0.875 273.5000               7.13
# 93                18.700      11.40  30.26250    21.9    1.250 137.8750               1.63
# 94                 7.250      11.90  37.15000    21.9    1.875 107.5000               7.25
# 95                14.600      18.10  48.76250    13.1    0.000 162.7500               7.00
# 96                18.800      13.10  33.76250    10.1    0.000 119.0625               7.75
# 97                12.200      11.90  26.76250    11.1    1.000  93.1000               7.63
# 98                17.500      17.70  51.66250    21.4    0.875 130.0000               4.25
# 99                27.000      21.80  62.46250    10.4    1.625 164.4375              14.50
# 100               31.000      17.10  38.61250    13.1    0.750 167.6250               7.00
# 101                2.270      18.10  42.86250    13.6    0.000 147.8750               6.88
# 102                2.070      19.00  50.87500    17.4    0.000 197.8750               7.88
# 103                3.060       8.27  27.26250    15.6    1.375  74.6750               7.75
# 104               10.800      12.50  37.23750    17.1    1.625  90.2250               7.25
# 105                2.710       9.31  35.76250    24.4    1.250  72.1500               4.00
# 106                3.420      10.40  27.23750    22.3    2.125  79.1375               6.50
# 107                6.330      10.60  38.42500    11.0    0.625 106.0375               6.75
# 108               44.300      42.80  67.50000    36.8    1.500 276.8125               7.00
# 109               45.200      23.70  50.86250    16.8    0.000 183.8125               7.25
# 110               44.300      40.80  65.35000    13.6    0.750 506.6875               3.75
# 111               35.200      42.70  85.02500    22.9    0.000 382.7500               7.25
# 112               33.300      23.80  47.53750    28.5    1.125 271.6250               1.00
# 113                3.500      16.30  38.96250    26.6    2.875 124.0000               6.00
# 114               59.400      30.30  74.28750    25.1    1.125 316.6875               6.13
# 115                5.350      16.20  32.16250    18.8    1.750 116.3125               7.25
# 116               34.200      25.30  88.25000    22.5    2.375 225.4375               7.25
# 117               52.500      33.70  49.90000    20.4    0.000 305.8750               5.50
# 118               58.800      32.60  77.46250    22.8    1.000 351.6875               7.25
# 119               60.800      19.90  60.36250    14.6    0.625 275.2500               6.63
# 120               24.000      21.20  43.93750    26.8    0.000 249.1250               7.63
# 121               68.300      45.20 381.18750    31.1    1.375 627.2500               6.38
# 122              118.000      35.00  81.51250    22.1    0.375 402.5000               8.63
# X2.Hydroxybutyrate X3.Hydroxybutyrate X14.1SMOH   X16.1SM   X16.0SM X16.1SMOH  X18.0SM  X18.1SM
# 1                 7.30              10.00  5.242230 11.121053  8.595825  6.569843 28.05302 5.458066
# 2                15.40              23.60  4.964675  7.779719  6.714199  5.599861 27.59621 5.542091
# 3                 5.90               4.40  3.085434  5.672962  6.398149  3.925506 27.05782 4.202480
# 4                13.00               8.80  5.832134  9.884494  7.295195  4.834720 27.29365 4.187238
# 5                 6.40               4.10  5.085851 12.347596  9.011835  7.207858 37.97094 5.828479
# 6                 8.80               8.80  6.679081 13.087631 11.746000 11.869181 18.42509 5.223071
# 7                 9.80               5.50  3.955962  6.501241  5.270211  4.629058 14.93595 2.743954
# 8                 8.50               6.60  5.865176 10.022323 10.708267  5.932612 36.02419 5.023282
# 9                20.80               8.00  3.519653  6.212917  6.213962  3.744447 20.64066 3.642959
# 10               14.90               7.40  7.048086 11.563262  9.079796  7.147369 34.59856 5.356343
# 11                7.50               7.30  5.109998  9.331855  7.570898  5.765650 31.79259 5.630957
# 12                8.50               7.80  3.633556  5.845475  5.869573  5.542884 29.49528 6.135088
# 13               10.00               3.10  4.212835  9.658828  7.447893  4.862480 19.31638 3.510836
# 14               12.60              12.40  5.768239 11.464144  9.712163  6.807624 31.78488 6.187467
# 15                9.10               7.50  6.342980 11.262932  8.946424  5.993752 27.71627 4.277668
# 16               13.20               7.50  7.531406 12.497353  9.393351  8.419274 41.30370 5.784305
# 17                5.10               7.50  6.710273 14.242576 13.066080  9.299649 43.08799 5.712768
# 18               12.90               4.60  5.071848  9.741041  9.117753  5.624840 18.46090 3.626111
# 19                6.40               6.00  4.763993  9.362049  7.835152  5.190149 17.56724 3.115491
# 20                8.80               8.80  6.451167 11.738729 10.018343  7.452184 23.43914 3.920671
# 21                5.60               6.00  4.870024 14.916798 10.690452  9.382232 11.86201 3.024955
# 22                8.40               5.00  5.773211 11.132846  8.546604  6.945170 22.19396 4.396889
# 23               13.80               2.90  6.817548 15.446364 11.438722  7.060960 30.32528 5.085865
# 24                6.30               3.90  7.563560 13.495176 11.930162  7.972405 17.69637 3.932525
# 25                7.10               3.00  5.233248  9.525574  8.183777  7.092545 22.46719 3.706726
# 26                9.60               9.90  6.320632 12.318438  9.354645  6.409383 20.59275 3.763266
# 27               13.90               3.00  5.153408 10.896255  8.563430  4.898995 28.79414 5.335017
# 28               11.10               1.90  5.154368  9.312634  8.757896  4.650372 12.22588 3.200633
# 29               10.00               5.60  5.022052  8.527269  7.095991  4.772125 13.33529 3.592522
# 30               13.00               5.40  3.700821  6.905995  5.900651  4.258091 15.30383 3.968997
# 31               13.00               2.80  5.319267  8.320395  7.963102  6.677861 25.32675 5.160569
# 32               10.30               5.00  6.361221 13.359112  9.923136 10.877407 15.10739 3.168013
# 33               13.00               6.10  7.198443 12.147141 10.032672  8.039462 42.51076 5.709656
# 34                9.10               5.90  5.562865  9.639395  9.326343  7.600184 21.08427 3.555496
# 35                7.40               4.50  6.690718 10.826071 10.034233 13.567293 28.30649 4.279505
# 36               11.90               1.50  4.506510 11.304855  9.001743  7.712317 24.06385 4.907941
# 37                7.80               1.60  4.461295  7.708501  7.550561  6.240623 17.46821 3.256082
# 38               13.00               7.30  3.464953  8.069699  6.628103  7.501587 16.07827 4.212883
# 39                8.90               4.50  5.599628 11.062907  9.833210 10.995199 16.69259 3.498530
# 40                5.80               3.80  7.744599 13.011819 12.107550 17.483341 23.78430 4.201824
# 41               26.90              20.00  7.284568 11.249729 10.112715 12.314023 42.23435 7.579572
# 42               15.30              10.90  3.608305 13.802669 11.124547  7.916904 19.05568 5.530227
# 43               15.60               3.30  6.143455 13.243319 13.774229 10.338134 20.37693 5.551913
# 44               16.10               8.30  5.316188 11.636679  9.214658  8.652581 16.24795 4.154954
# 45                7.80               7.30  4.986488 10.246237  8.227844 11.764865 17.74349 3.185722
# 46               16.90               7.90  4.285544 10.046408 10.065290  9.259691 17.26404 4.907479
# 47                5.90               3.60  6.175772 13.045721  9.736524 11.304352 21.95239 3.876233
# 48               13.00               8.80  6.135092 10.875167 10.109827  5.959881 19.31894 4.104084
# 49                7.60               6.30  7.177890 14.586119 13.929210 12.879846 16.63252 5.153520
# 50               10.00               4.50  5.033622 11.308865 11.417163  6.071680 20.67292 4.918132
# 51               19.50               2.80  5.806989 12.662932  9.759441  8.535555 13.18772 3.436073
# 52               18.00               8.80 12.943157 17.176097 21.553873 11.834533 34.00146 7.643371
# 53               11.10               8.80  9.560637 19.114590 15.484005 16.003915 18.38119 4.287974
# 54               11.40               2.60  4.919101 12.640689 11.872000 13.557964 17.36607 4.791150
# 55               18.80               3.30  5.559791 12.695464 11.389262 10.570639 31.04393 8.429627
# 56               10.50               6.90  4.154387  8.172009  8.757901  5.146712 15.80944 4.869667
# 57                7.90               7.50  7.707211 13.874947 11.155487  8.429846 23.05225 3.787206
# 58               19.50               3.80  3.222090  9.650612  8.537209  8.592906 13.47276 5.396715
# 59               17.30               4.30  4.787302 11.462623 11.250368  7.977467 27.74287 5.944892
# 60                6.50               3.40  3.702719  7.951735  7.718931  5.248209 23.96277 5.583637
# 61                5.80               2.40  3.377739  9.994291  9.167854  5.836035 18.01340 5.333649
# 62                7.80               5.60  3.877966 11.664567  9.211695  7.892337 27.52974 5.756573
# 63                6.13              10.88  4.316300  8.360200  7.070900  4.446200 29.55610 5.856700
# 64                6.88               4.75  3.196000  5.412100  5.146800  5.432400  8.10510 2.058600
# 65               10.75              11.13  6.043900  7.864300  7.791400  8.288600 11.75010 2.486800
# 66                5.38               2.13  2.648000  4.191800  4.194200  2.740600 19.43630 3.225500
# 67                6.13               7.25  2.984500  5.132700  4.327600  3.575500 18.55660 3.496300
# 68               16.13               7.38  2.663000  4.183400  3.959200  2.974000 17.12240 2.775200
# 69               13.38              10.50  4.125000  7.750300  5.568100  3.875400 14.50590 2.661300
# 70                4.38              12.88  4.410000  7.022000  6.883000  4.367200 26.04600 4.442400
# 71                3.25              14.13  3.254500  6.788700  5.029400  3.085800 22.37800 3.601500
# 72               21.88              40.88  3.691400  6.406600  5.197400  3.309500 12.94050 2.626100
# 73                6.50               6.88  1.761700  3.842400  2.759400  2.322200  7.71610 1.681600
# 74                7.63               3.50  3.832800  6.019400  5.757300  4.848200  9.74250 2.725200
# 75                2.75               6.75  4.475900  8.427100  5.634000  9.070200 14.30010 2.918800
# 76                3.63               4.75  2.933700  4.857900  4.404600  5.998800  7.12370 1.597700
# 77                2.75               4.63  3.363100  4.936600  6.079700  4.972900  6.59470 1.456700
# 78                4.25               5.00  3.619600  5.057200  4.922400  3.552900 17.33400 3.254600
# 79               10.13               2.13  4.201800  6.543800  5.217900  6.808000 14.26260 2.625700
# 80                2.25               2.13  4.327600  6.577500  6.440800  8.137500 11.61990 2.245100
# 81               15.00               1.88  2.916200  4.419400  4.834400  6.586000  7.69570 1.446400
# 82                4.13               1.50  7.162700  9.737900  8.412200 11.177800 20.46520 4.072300
# 83                2.38               1.63  2.387400  3.896500  3.497100  2.817200 14.00810 2.651300
# 84                6.13               8.88  3.907100  5.617400  4.603300  3.764300 14.80140 3.161300
# 85                6.13              11.88  4.606600  8.066100  6.966200  7.692100 14.78520 3.513300
# 86                5.38               3.75  2.882600  4.317900  3.964800  5.325300 20.58660 3.146500
# 87                5.38               1.21  4.472000  7.003900  6.705500  7.728700 10.65510 2.288100
# 88               17.25               4.63  5.018200  7.155900  7.832000  5.154400 19.97230 3.884900
# 89               13.00               4.38  6.850600 10.194800 10.394700  8.130300 11.76110 3.274500
# 90               26.50               3.00  3.442100  5.055100  4.584900  3.298100 20.23420 3.137500
# 91                4.25               3.00  4.471400  6.615200  6.545800  3.608000 10.71940 3.024500
# 92                7.00               7.88  4.443200  8.044500  7.674500  4.554400 13.89360 3.198100
# 93               15.75               3.38  4.054100  7.152000  6.448400  7.542000 16.16330 4.911500
# 94                7.13               6.38  3.547200  6.194700  5.758800  7.064300  9.96390 2.003600
# 95                9.50               2.25  6.398200  9.619200  9.057600  8.373300 19.56040 4.430600
# 96                3.50               5.25  5.494700  8.874200  7.863100  7.369000 12.39190 3.598600
# 97                2.38               4.50  3.263200  4.808000  4.451600  4.358900  8.69030 1.687400
# 98                5.50               4.00  5.419300  8.017600  7.054100  7.525400 10.46340 2.371800
# 99                4.63               6.63  5.777000  8.095700  7.497000  6.671200 12.04960 2.736800
# 100               6.88               9.88  5.197600  6.912700  6.258400  6.643800 12.80580 2.686900
# 101              13.00              22.38  4.304400  9.313300  7.511900  4.323900 13.54600 3.531800
# 102               6.00               6.38  4.825900  7.591900  6.563700  3.904600 16.62030 2.819100
# 103              10.38              18.38  2.936900  8.317400  5.567200  4.457700  8.89100 1.986300
# 104               3.00               7.00  5.464200 10.049100  8.357200  4.683500 14.49530 3.837300
# 105               6.50               3.13  3.248200  6.768200  5.736500  3.487300 10.64730 2.230200
# 106              10.63               8.75  4.372500  7.887600  8.639100  7.548900  7.93280 2.018200
# 107               7.75               6.35  4.106500  7.828900  6.255100  4.142000 10.15690 2.605900
# 108              15.63               8.25  4.333000 10.912300  9.584300 12.747000  8.54230 2.489500
# 109               4.25               6.38  5.792300 12.692700 12.120600  9.509600 11.00550 3.887600
# 110              21.00              14.25  5.622700 11.481800 11.538900 14.323700 16.22490 4.060500
# 111              24.38              52.88  8.506400 20.918600 17.205000 12.865600 17.54520 4.663700
# 112              13.00               8.88  6.069400 12.328400 14.174400 11.622400 12.52670 3.667000
# 113               8.13               6.00  3.983300  8.211900  6.990600  9.904400  8.98810 2.002900
# 114              27.13              18.50  5.623800 14.747400 12.169400 13.496800  9.35590 2.667500
# 115              15.50               5.38  4.878700 12.544100  8.330500  7.293800  9.94480 2.730300
# 116               5.75               8.00  4.441700 10.007400  8.350900  7.127800  9.52500 2.867700
# 117              52.13               6.38  3.879400  9.024700  6.422300  9.151300  9.90280 2.333200
# 118              29.88              18.25  4.243700 12.163900  9.105900  7.275700 11.66810 3.205300
# 119              22.00               5.88  3.932800 11.011800  9.880900  6.499000 10.51520 2.922100
# 120               7.75               4.75  4.323100 10.694500  9.931600 10.233900 11.87710 3.827600
# 121              49.13               8.00  3.033600 10.346900  8.759400  6.233900  8.73770 3.426700
# 122              19.63               6.25  3.828200 14.392900 11.577300  8.993000 12.21900 5.459300
# X20.2SM X22.2SMOH X22.1SMOH X24.1SMOH
# 1    24.921846  5.797033  4.284946 18.526949
# 2    22.290544  6.541887  4.764120 19.923065
# 3    15.292562  4.722604  2.948353  6.403086
# 4    20.500035  5.809009  3.771895 15.049665
# 5    24.887733  8.039435  4.870789 15.135461
# 6    16.895668  9.032734  5.005197 17.818264
# 7    12.518717  3.865028  2.330167  9.152316
# 8    23.673935  7.695115  4.616206 17.961162
# 9    15.696448  5.919569  3.397738 10.636897
# 10   24.349785  7.840531  5.352515 19.263063
# 11   25.741319  6.443634  4.368991 18.506398
# 12   19.491037  6.212550  3.918578 11.316785
# 13   14.256474  5.788234  3.101876  9.736228
# 14   29.164677  6.580289  4.825618 17.461735
# 15   21.832369  7.847256  5.514988 19.958498
# 16   28.337254  7.471594  5.343516 21.697080
# 17   24.103036 13.258245  6.705316 18.921713
# 18   14.124028  6.675362  3.485182 10.922395
# 19   15.901425  6.455399  3.922554 12.823510
# 20   18.223772  8.548953  4.786466 15.242828
# 21    9.851628  6.918314  3.171772  9.085626
# 22   17.801979  8.189498  4.885389 18.694633
# 23   23.402103  8.813014  5.577668 21.418790
# 24   16.421115  8.511807  5.179924 20.529345
# 25   16.470384  7.335220  4.361800 14.977450
# 26  444.000000  6.381151  4.248411 15.507493
# 27   21.738970  7.679645  4.814080 12.632843
# 28   10.575160  6.454505  3.259805  9.124496
# 29   14.860900  6.823011  3.923335 10.732590
# 30   15.424747  5.146578  3.361313 10.165603
# 31   19.698736  6.234349  3.967123 12.750414
# 32   11.613396  8.265779  3.917491 15.406030
# 33   25.450777  7.177697  5.245765 19.961488
# 34   16.022978  7.070263  3.967922 15.937957
# 35   17.159070  9.599158  4.554119 14.653096
# 36   14.078142  8.832657  4.276566  6.663744
# 37   12.956078  6.100783  3.503059  9.458833
# 38   17.871706  5.432710  3.765433  8.327908
# 39   16.605389  9.538703  4.691575 11.441664
# 40   16.277731 10.416730  5.410045 16.533062
# 41   25.849813 12.713405  7.095508 16.926576
# 42   14.212185  8.970271  4.601624  6.945067
# 43   18.085982 13.056559  6.668197 10.161384
# 44   13.676210  9.006273  4.288524  8.513184
# 45   10.437715  6.618565  3.574510  8.362469
# 46   13.965464  8.186343  4.070115  7.414161
# 47   13.139869  8.560951  4.529573 20.223570
# 48   13.165811 14.866709  6.485507 12.930194
# 49   18.742604 13.456234  6.803319 13.833850
# 50   21.594755 11.343523  6.119647 13.795871
# 51   10.628592 11.972815  5.830117  8.344132
# 52   35.964272 20.397872 11.531610 23.400400
# 53   16.504058 14.335726  6.366588 14.490112
# 54   13.220245 10.872959  5.675361  6.689477
# 55   21.802486 13.942221  7.411335 12.673023
# 56   14.283349  8.822188  4.424346  8.041745
# 57   16.162562 15.747183  7.434713 12.199709
# 58    8.609220  7.968541  4.040110  5.000530
# 59   24.853899 17.465860  8.133798 16.796632
# 60   24.654150  8.782540  6.058806 22.509647
# 61   22.626074  7.003436  5.306988 20.263482
# 62   19.995466 11.980397  5.755905 15.065142
# 63   21.745700  8.082900  5.798500 17.599600
# 64    6.349000  7.268500  3.730900  9.253100
# 65    7.424200 10.053900  4.743000 17.434200
# 66   11.014700  4.758300  3.722300  9.056700
# 67   14.891100  5.138200  3.814000 14.681300
# 68    9.781300  4.907900  2.889500  9.038800
# 69    9.117500  6.086200  3.209100  9.969900
# 70   16.744400  7.681400  4.776800 15.658500
# 71   12.158700  6.113500  4.039700  9.515800
# 72    8.132700  6.566000  4.130400 11.850800
# 73    6.522900  3.798100  2.071500  6.710400
# 74   10.928600  8.847400  4.344700 14.475000
# 75    9.628700  9.475300  5.457000 17.497300
# 76    4.067600  6.127900  2.624300  6.898000
# 77    3.843900  5.918100  2.752400  6.372500
# 78   12.127100  5.979300  3.382200 14.129700
# 79    5.458600  7.478000  3.071900  7.218000
# 80    7.693100  9.111500  4.213300 13.105300
# 81    3.343100  4.375300  2.128500  4.490000
# 82   14.122300 13.611200  6.322100 21.248100
# 83    7.248700  3.904800  2.266200  6.034700
# 84   11.103400  5.681100  3.356900 11.831000
# 85   11.638800 11.124300  5.067400 14.584200
# 86    8.269900  6.516200  2.944600  7.541200
# 87    5.857900  6.941500  3.168300  7.548400
# 88    8.651800  8.654000  4.209800  8.392600
# 89    7.620200  9.429700  4.011600 10.320100
# 90   10.663000  4.984200  3.306500  9.743400
# 91    9.195600  7.255200  3.569300 14.747600
# 92   11.538400  7.088900  4.920000 14.758900
# 93   13.635100  8.931100  5.028700 10.124100
# 94    6.479200  7.169400  3.186600  6.883200
# 95   16.500300 15.168300  6.856200 13.341000
# 96   12.370100 12.555000  6.060200 14.459100
# 97    5.381900  5.265200  2.319000  5.536200
# 98    6.910900 11.486800  4.553700  9.212600
# 99    8.557400 11.466600  4.984500 11.926700
# 100  10.790500 10.530200  4.825400 15.289300
# 101  10.994600  7.882300  4.323900 14.241100
# 102   9.301200  5.875900  3.547200  9.950300
# 103   3.102800  5.390100  2.275800  6.655200
# 104  14.853200  8.386400  5.151100 20.884900
# 105   6.952100  5.210400  3.127900 10.239000
# 106   4.983800  8.704400  3.505800  9.090100
# 107   8.188200  6.517000  4.052300 13.785400
# 108   7.144500 10.877300  4.475100  7.951900
# 109  10.080100 12.589800  5.391600 11.193800
# 110  10.701600 13.143400  5.981500 12.355500
# 111  13.444700 26.864300  9.968600 17.780900
# 112   9.598500 13.617900  5.587900  9.764500
# 113   5.415800  9.769600  3.787600  9.418200
# 114   6.512600 13.891200  5.227200 11.705000
# 115   8.197600  8.011200  3.884200 10.215500
# 116   9.366600 10.616400  5.167900 11.051600
# 117   5.584900  8.284200  3.435000  9.320300
# 118  10.548700 13.125600  6.196600 11.367900
# 119   7.915800 11.956200  5.151600  9.415600
# 120  12.133700 12.699300  6.679400 16.040300
# 121   7.157200  9.518400  4.935000  7.456400
# 122   8.949700 11.381900  4.994300  9.048600
 
corrplot(DM_cor, type = "upper", order = "hclust", 
           +          tl.col = "black", tl.srt = 60, 
           +          tl.cex = 1, cl.cex = 1)
DM_pca_FM <- PCA(DM_data_pca, graph = FALSE)
# extract eigenvalues/varianes
get_eig(DM_pca_FM)
#eigenvalue variance.percent cumulative.variance.percent
# Dim.1   36.061359087     22.969018527                    22.96902
# Dim.2   18.488278667     11.775973673                    34.74499
# Dim.3   18.016638877     11.475566164                    46.22056
# Dim.4    8.736990470      5.564962083                    51.78552
# Dim.5    8.159685574      5.197251958                    56.98277
# Dim.6    5.881517811      3.746189689                    60.72896
# Dim.7    4.734101600      3.015351337                    63.74431
# Dim.8    3.906513215      2.488224978                    66.23254
# Dim.9    3.171245191      2.019901396                    68.25244
# Dim.10   3.137516720      1.998418293                    70.25086
# Dim.11   2.871281208      1.828841534                    72.07970
# Dim.12   2.186270488      1.392528973                    73.47223
# Dim.13   2.055967587      1.309533495                    74.78176
# Dim.14   1.960035124      1.248430015                    76.03019
# Dim.15   1.896576788      1.208010693                    77.23820
# Dim.16   1.870120281      1.191159415                    78.42936
# Dim.17   1.604480397      1.021962036                    79.45132
# Dim.18   1.485005514      0.945863384                    80.39719
# Dim.19   1.428291386      0.909739736                    81.30693
# Dim.20   1.397842228      0.890345368                    82.19727
# Dim.21   1.347307484      0.858157633                    83.05543
# Dim.22   1.282919589      0.817146235                    83.87258
# Dim.23   1.213815274      0.773130748                    84.64571
# Dim.24   1.139528365      0.725814246                    85.37152
# Dim.25   1.112086295      0.708335220                    86.07986
# Dim.26   1.045890869      0.666172528                    86.74603
# Dim.27   0.984955461      0.627360166                    87.37339
# Dim.28   0.954355116      0.607869501                    87.98126
# Dim.29   0.900763565      0.573734755                    88.55499
# Dim.30   0.812643688      0.517607445                    89.07260
# Dim.31   0.774258789      0.493158464                    89.56576
# Dim.32   0.766242420      0.488052497                    90.05381
# Dim.33   0.700232036      0.446007666                    90.49982
# Dim.34   0.693185519      0.441519439                    90.94134
# Dim.35   0.660062213      0.420421792                    91.36176
# Dim.36   0.628661722      0.400421479                    91.76218
# Dim.37   0.601899848      0.383375699                    92.14556
# Dim.38   0.561114185      0.357397570                    92.50296
# Dim.39   0.545727307      0.347597011                    92.85055
# Dim.40   0.512809169      0.326630044                    93.17718
# Dim.41   0.477117563      0.303896537                    93.48108
# Dim.42   0.457917921      0.291667466                    93.77275
# Dim.43   0.443002981      0.282167504                    94.05491
# Dim.44   0.439389797      0.279866112                    94.33478
# Dim.45   0.409712228      0.260963202                    94.59574
# Dim.46   0.396656838      0.252647668                    94.84839
# Dim.47   0.377296209      0.240316056                    95.08871
# Dim.48   0.361960018      0.230547782                    95.31926
# Dim.49   0.346199844      0.220509455                    95.53976
# Dim.50   0.336230582      0.214159606                    95.75392
# Dim.51   0.323283439      0.205913019                    95.95984
# Dim.52   0.305280975      0.194446481                    96.15428
# Dim.53   0.302899472      0.192929600                    96.34721
# Dim.54   0.290504744      0.185034869                    96.53225
# Dim.55   0.287004370      0.182805331                    96.71505
# Dim.56   0.250957500      0.159845541                    96.87490
# Dim.57   0.245063294      0.156091270                    97.03099
# Dim.58   0.242558311      0.154495740                    97.18549
# Dim.59   0.225969514      0.143929627                    97.32942
# Dim.60   0.210783238      0.134256840                    97.46367
# Dim.61   0.208576873      0.132851512                    97.59652
# Dim.61   0.208576873      0.132851512                    97.59652
# Dim.62   0.189853556      0.120925832                    97.71745
# Dim.63   0.185704687      0.118283240                    97.83573
# Dim.64   0.174403949      0.111085318                    97.94682
# Dim.65   0.168439542      0.107286332                    98.05410
# Dim.66   0.165243826      0.105250845                    98.15936
# Dim.67   0.162883091      0.103747191                    98.26310
# Dim.68   0.149882180      0.095466357                    98.35857
# Dim.69   0.141266513      0.089978671                    98.44855
# Dim.70   0.140598629      0.089553267                    98.53810
# Dim.71   0.131784318      0.083939056                    98.62204
# Dim.72   0.127474728      0.081194094                    98.70323
# Dim.73   0.118268138      0.075330024                    98.77856
# Dim.74   0.109423050      0.069696210                    98.84826
# Dim.75   0.106361145      0.067745953                    98.91601
# Dim.76   0.099863819      0.063607528                    98.97961
# Dim.77   0.094553145      0.060224933                    99.03984
# Dim.78   0.092355589      0.058825216                    99.09866
# Dim.79   0.089119727      0.056764157                    99.15543
# Dim.80   0.086018779      0.054789032                    99.21022
# Dim.81   0.081410088      0.051853560                    99.26207
# Dim.82   0.078694941      0.050124166                    99.31220
# Dim.83   0.073519151      0.046827484                    99.35902
# Dim.84   0.068277412      0.043488797                    99.40251
# Dim.85   0.064804537      0.041276775                    99.44379
# Dim.86   0.062074394      0.039537831                    99.48333
# Dim.86   0.062074394      0.039537831                    99.48333
# Dim.87   0.059015259      0.037589337                    99.52092
# Dim.88   0.056387921      0.035915873                    99.55683
# Dim.89   0.053499613      0.034076187                    99.59091
# Dim.90   0.053206746      0.033889647                    99.62480
# Dim.91   0.047570031      0.030299383                    99.65510
# Dim.92   0.043487203      0.027698855                    99.68280
# Dim.93   0.041334569      0.026327751                    99.70912
# Dim.94   0.039811872      0.025357880                    99.73448
# Dim.95   0.037841257      0.024102711                    99.75858
# Dim.96   0.035150283      0.022388716                    99.78097
# Dim.97   0.033547600      0.021367898                    99.80234
# Dim.98   0.031833261      0.020275963                    99.82262
# Dim.99   0.027550568      0.017548133                    99.84016
# Dim.100  0.024781400      0.015784331                    99.85595
# Dim.101  0.023627845      0.015049583                    99.87100
# Dim.102  0.021339819      0.013592241                    99.88459
# Dim.103  0.020359234      0.012967665                    99.89756
# Dim.104  0.018798456      0.011973539                    99.90953
# Dim.105  0.015670642      0.009981301                    99.91951
# Dim.106  0.014790351      0.009420606                    99.92893
# Dim.107  0.014304124      0.009110907                    99.93804
# Dim.108  0.012067791      0.007686491                    99.94573
# Dim.109  0.011865792      0.007557829                    99.95329
# Dim.110  0.010184882      0.006487186                    99.95978
# Dim.111  0.009503565      0.006053226                    99.96583
# Dim.112  0.008757893      0.005578276                    99.97141
# Dim.113  0.008366260      0.005328828                    99.97674
# Dim.114  0.007208119      0.004591158                    99.98133
# Dim.115  0.006288162      0.004005199                    99.98533
# Dim.116  0.005473578      0.003486355                    99.98882
# Dim.117  0.004929121      0.003139567                    99.99196
# Dim.118  0.004080153      0.002598823                    99.99456
# Dim.119  0.003631475      0.002313041                    99.99687
# Dim.120  0.002704621      0.001722689                    99.99859
# Dim.121  0.002208759      0.001406853                   100.00000
fviz_screeplot(DM_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = Inf
)
fviz_screeplot(DM_pca_FM, addlabels = TRUE, 
               ggtheme = theme_classic(),
               main = "",
               font.x = c(14, "bold"), font.y = c(14, "bold"),
               font.tickslab = 12,
               barfill = "#99d8c9", barcolor = "#66c2a4",
               font.submain = 16,
               ncp = 16
)

# extract the results for variables
var <- get_pca_var(DM_pca_FM)
var
# Principal Component Analysis Results for variables
#   Name       Description                                    
# 1 "$coord"   "Coordinates for the variables"                
# 2 "$cor"     "Correlations between variables and dimensions"
# 3 "$cos2"    "Cos2 for the variables"                       
# 4 "$contrib" "contributions of the variables"
head(var$coord)  # coordinates of variables
head(var$contrib) # contributions of variables to the PCs
head(var$cos2)  # Cos2: quality on the factore map
var$coord
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# Creatinine                   0.15700898  0.160296888  0.449890178 -0.025044769 -0.272364589
# Acetamide                    0.44717835 -0.247909860 -0.361480023 -0.063243593  0.118291299
# Acetate                      0.14021050 -0.074739392  0.458779543  0.143300597 -0.021098308
# Acetoacetate                 0.14639251 -0.118363502 -0.117482298  0.044006485 -0.206362440
# Acetone                      0.65551879 -0.216057431  0.008017856  0.189838983 -0.034542096
# Acetyl.Ornithine             0.18182696  0.379788289  0.282901568  0.075142809  0.019578030
# Adenosine                   -0.56832961 -0.092565890  0.236354621  0.200356102  0.004927411
# ADP                         -0.06679964 -0.439667294 -0.191599654 -0.003612412  0.187166117
# AMP                          0.50981958 -0.231832200 -0.033251038 -0.473468152 -0.208636830
# ATP                          0.14021469 -0.292265073 -0.249929610  0.127117759  0.060669642
# Alanine                      0.64823936  0.206472060 -0.095871854  0.118311823  0.245904091
# Alpha.Aminoadipic.Acid       0.14871968  0.290168000  0.262365450  0.259155362  0.129980827
# Arginine                     0.83258395  0.053250498 -0.295708727 -0.007766767  0.158187264
# Asparagine                   0.09813330  0.705952254  0.312186865  0.025352669 -0.110557113
# Aspartate                    0.60799269  0.332531002 -0.184474735 -0.187657738 -0.174586677
# Asymmetric.Dimethylarginine  0.68158262  0.495412704  0.057176675  0.015954160 -0.013275670
# Beta.Alanine                -0.53319635 -0.089378933  0.218032370  0.038007892  0.100071671
# Beta.Hydroxybutyrate         0.12489342 -0.173492948  0.604472678  0.450594279 -0.244799956
# Betaine                     -0.40136264 -0.035199843  0.242999727  0.062333501  0.197937004
# Carnitine                    0.61708397 -0.308386031 -0.023960140  0.036306459 -0.028052589
# C10                          0.66405496 -0.250851443 -0.073141738 -0.089462423 -0.380949074
# C10.2                        0.69222043 -0.205538979 -0.107709866 -0.288960818 -0.282402227
# C10.1                       -0.58490535  0.022703575  0.256286640  0.356160363  0.219445071
# C12.1                        0.02355643 -0.446690754  0.514272290  0.259335340 -0.409812541
# C12                          0.60608155 -0.325210286 -0.119563958  0.265451015 -0.021763998
# C12DC                        0.23316071  0.241770567  0.133375112  0.064623899  0.342676086
# C14.2                        0.75148579 -0.359323791 -0.056858262 -0.021764248 -0.314920104
# C14.1                        0.07530879 -0.543280067  0.566682048  0.446118388 -0.160106937
# C14                          0.48961683 -0.526131391  0.270063385  0.412845887 -0.138289365
# C14.2OH                      0.79935276 -0.484985412  0.008170084  0.154915756 -0.161472416
# C14.1OH                      0.53636303 -0.583446637  0.312075710  0.344294644 -0.233766199
# C16.2                        0.84631125 -0.310969517 -0.158661801  0.038394694 -0.156374973
# C16.1                        0.34053017 -0.666343933  0.297586367  0.482528159 -0.054318883
# C16                          0.28384641 -0.649205865  0.327116281  0.458349804 -0.072053092
# C16.2OH                      0.75027521 -0.506546714  0.094711119  0.174169774 -0.239061585
# C16.1OH                      0.52303801 -0.612114560  0.330808807  0.291128018 -0.158779025
# C16OH                        0.43580411 -0.355450856  0.157518642  0.248521107 -0.227328845
# C18_2                        0.80162084 -0.490088499  0.004926458  0.202268809 -0.111188921
# C16.2                        0.84631125 -0.310969517 -0.158661801  0.038394694 -0.156374973
# C16.1                        0.34053017 -0.666343933  0.297586367  0.482528159 -0.054318883
# C16                          0.28384641 -0.649205865  0.327116281  0.458349804 -0.072053092
# C16.2OH                      0.75027521 -0.506546714  0.094711119  0.174169774 -0.239061585
# C16.1OH                      0.52303801 -0.612114560  0.330808807  0.291128018 -0.158779025
# C16OH                        0.43580411 -0.355450856  0.157518642  0.248521107 -0.227328845
# C18_2                        0.80162084 -0.490088499  0.004926458  0.202268809 -0.111188921
# C18_1                        0.33430782 -0.669710929  0.325298919  0.477071446 -0.035436438
# C18                          0.39622969 -0.564209086  0.169227309  0.410178995  0.075712778
# C18_1OH                      0.63149001 -0.533869277  0.231622835  0.181831584 -0.239992035
# C2                          -0.14445393 -0.320497227  0.369209852  0.322665065  0.110309821
# C3_1                         0.11516764  0.061573831  0.555345169 -0.169034341 -0.382592226
# C3                           0.45010967  0.617764476  0.263721527  0.026719953 -0.082837083
# C4_1                         0.63814125  0.067713506  0.202027735 -0.297065655 -0.241912226
# C4                           0.26047217  0.285878617  0.592298333  0.193436286 -0.271485193
# C3OH                        -0.57683441 -0.052289953  0.462651718  0.146732346 -0.038165812
# C5_1                         0.76582119  0.057412593 -0.035240261 -0.315756184 -0.360764841
# C5                           0.16532558  0.640247362  0.405497914  0.036856357 -0.258531302
# C4OH                         0.14609098 -0.122716284  0.533755738  0.252558584 -0.206814008
# C6_1                         0.70318157 -0.127142128 -0.047860382 -0.387163022 -0.408927951
# C6                           0.72095671 -0.174591638  0.011081998 -0.244784149 -0.447888277
# C5OH                         0.38697826 -0.018778746  0.137897082 -0.005846604 -0.052319147
# C5_1DC                       0.29336139 -0.074763116  0.468753208  0.082301259 -0.555511262
# C5DC                         0.39202315 -0.138631554  0.306239091 -0.041345462 -0.533963396
# C8                           0.25999602 -0.354500768  0.504302924  0.338997772 -0.325914593
# C5DC                         0.39202315 -0.138631554  0.306239091 -0.041345462 -0.533963396
# C8                           0.25999602 -0.354500768  0.504302924  0.338997772 -0.325914593
# C5MDC                        0.76421134 -0.256205781 -0.083823536 -0.113475458 -0.307950966
# C9                           0.78615678 -0.257631128 -0.014744890 -0.092072815 -0.342124712
# C7DC                         0.16568331  0.052729964 -0.118388893  0.086081044  0.008319284
# Creatine                     0.14125626  0.256854235  0.526064797 -0.055179466 -0.298569322
# Choline                      0.12415725 -0.296886394  0.169775844  0.137153498  0.474519054
# Citrate                     -0.21698828  0.200349954  0.667462060  0.304060813 -0.186747483
# Creatine.Phosphate           0.07722621  0.202085133  0.123493706  0.065099071  0.102215885
# Citrulline                  -0.12250885  0.236936052  0.021502036 -0.159008965 -0.002678516
# Cytidine                     0.65971889  0.047776392 -0.208816472  0.031827142  0.183705166
# Dimethyl.Sulfone            -0.52884078  0.230821442  0.422279076  0.027396872 -0.260837717
# Ethanol                      0.11276375 -0.105565678 -0.009697579 -0.274606602 -0.050646829
# Ethanolamine                 0.08833138 -0.334882198 -0.190016354  0.071240030  0.251865049
# Formate                     -0.29374738 -0.057160986  0.259873813 -0.318212327 -0.148038649
# Glucose                      0.24445878  0.363909642  0.022270039 -0.150468731  0.292971516
# Glutamine                    0.63280783  0.315794185 -0.036240437  0.113605747  0.132372308
# Glutamate                    0.74579402  0.141837422 -0.144812351  0.239855685  0.253740684
# Glycerol                     0.41400708 -0.068216742 -0.154736496  0.042120044  0.061492176
# Glycine                      0.51955506  0.196208943  0.116123139  0.364681111  0.106334275
# Guanidoacetate               0.69862637 -0.015020124 -0.338775879 -0.080992830  0.127947187
# Guanosine                    0.57456084 -0.329255697 -0.154130145 -0.227769552 -0.002489262
# Hypoxanthine                 0.74017794  0.012944528 -0.308566950 -0.002111637  0.134895823
# IMP                          0.73621904  0.229915309 -0.303578513  0.118053122  0.176452998
# Inosine                      0.62577916  0.115438808 -0.156557836 -0.184285804 -0.100668806
# Inosine                      0.62577916  0.115438808 -0.156557836 -0.184285804 -0.100668806
# Histidine                    0.59066383  0.535159994  0.107177131  0.052291625  0.101768729
# Isobutyrate                  0.51379960  0.585333138 -0.053578907 -0.091652259 -0.079267984
# Isoleucine                   0.41992971  0.780017106  0.115309551  0.164961765 -0.017678886
# Isopropanol                  0.11776761 -0.107934413  0.004749898 -0.295190224 -0.074041898
# Lactate                      0.18538201  0.405151417  0.404162687  0.140160384  0.087955560
# Kynurenine                   0.17088032  0.316415473  0.387825050  0.129146123  0.057369393
# Lysine                       0.81192959  0.323496140 -0.303436862  0.004664788  0.089741763
# Leucine                      0.53334856  0.701920982 -0.007100469  0.089469848  0.072155193
# LYSOC14.0                    0.07258368 -0.352096249  0.420301196 -0.530985685  0.153046047
# LYSOC16.1                   -0.14459946 -0.253158945  0.487519033 -0.319157893  0.273062717
# LYSOC16.0                    0.13632604 -0.386286558  0.250374039 -0.512736045  0.202203226
# LYSOC17.0                   -0.04465110 -0.435271337  0.493342294 -0.495463053  0.211716724
# LYSOC18.2                    0.57808574 -0.085139950  0.267705866 -0.240264362  0.413622965
# LYSOC18.1                    0.48995605 -0.260324103  0.352344135 -0.250957779  0.444804904
# LYSOC18.0                    0.42102250 -0.159621404  0.362489921 -0.178343769  0.472567511
# LYSOC20.4                    0.37670986  0.387666847  0.327632709  0.059770936  0.197317553
# LYSOC20.3                    0.37128031 -0.060685959  0.270117791 -0.047133841  0.164262194
# LYSOC24.0                   -0.31513079 -0.280301013  0.497532583 -0.309610501  0.111117409
# LYSOC26.1                    0.13302632 -0.226111073  0.498389663 -0.519111446  0.132378595
# LYSOC26.0                    0.17219892 -0.358578751  0.308962624 -0.570701391  0.139746937
# LYSOC28.1                   -0.14316052 -0.094317327  0.769426919 -0.369030499  0.070886655
# LYSOC28.0                    0.17881446 -0.315163238  0.399146268 -0.539119735  0.057214581
# PC32.2AA                     0.29269279 -0.376142858  0.277490162  0.096768625  0.551589884
# PC36.0AE                    -0.26599378  0.365629643  0.751689641 -0.113741252 -0.043931990
# PC32.2AA                     0.29269279 -0.376142858  0.277490162  0.096768625  0.551589884
# PC36.0AE                    -0.26599378  0.365629643  0.751689641 -0.113741252 -0.043931990
# PC36.6AA                     0.33352211 -0.061113860  0.560676870 -0.133330395  0.503187468
# PC36.0AA                    -0.16002937  0.513421487  0.533968062 -0.184043278 -0.152860369
# PC38.6AA                     0.13823757 -0.208225263  0.613326079  0.026795828  0.515372063
# PC38.0AA                    -0.24278363  0.203003011  0.827413352 -0.015446202  0.044809922
# PC40.6AE                     0.07823023 -0.205930802  0.725774816 -0.049112791  0.393471945
# PC40.6AA                     0.41078936 -0.139023997  0.322630974  0.117580906  0.600811464
# PC40.2AA                     0.21430533 -0.200105723  0.670175047 -0.513452762  0.140126644
# PC40.1AA                     0.16864081 -0.252160209  0.682672421 -0.294400407  0.297827620
# Phenylalanine                0.53075209  0.683852838  0.037934015  0.219046861  0.216093078
# Proline                      0.56365427  0.711698185  0.064513195  0.103911307  0.027364179
# Propylene.glycol             0.06400402  0.544895414  0.139230881  0.058713733 -0.297566157
# Putrescine                   0.02467752  0.363790507  0.467995951  0.073672369 -0.042310489
# Pyruvate                    -0.50851575 -0.120487571  0.370603046  0.350223919  0.275581964
# Sarcosine                    0.30433549  0.252868976  0.099660162  0.298736851  0.236681010
# Serine                       0.38093938  0.021332131  0.133045083  0.447257848  0.423050220
# sn.Glycero.3.phosphocholine  0.71101805 -0.287326576 -0.313887196  0.044349563  0.199248555
# Spermidine                   0.30351278  0.369565807  0.259539866 -0.086478068 -0.034939825
# Spermine                    -0.20545117  0.234804659  0.670357843  0.093082337  0.002981476
# Succinate                    0.12614820  0.001949949  0.070605419  0.341211984  0.369066552
# Taurine                      0.80119580 -0.063047067 -0.207390426 -0.166181112  0.064184969
# Threonine                    0.59236766  0.305930600  0.137476843  0.212032578  0.193281146
# Total.Dimethylarginine       0.63087723  0.473517069  0.167006733  0.109687899 -0.002950708
# Threonine.1                  0.59236766  0.305930600  0.137476843  0.212032578  0.193281146
# Malate                       0.78962433  0.057409708 -0.218312291  0.111233008  0.194879790
# Malonate                     0.71364974  0.080157942 -0.003227720 -0.308147662 -0.179229823
# Mannose                      0.67354056  0.228651799 -0.351486406 -0.075012874 -0.015968705
# Methanol                    -0.60749450 -0.002207088  0.355296959 -0.098717307 -0.181605275
# Methionine                   0.73140966  0.431182120 -0.070697778  0.112754901  0.132976135
# Methionine.Sulfoxide        -0.44591465  0.327922453  0.374126834  0.221712985  0.133701094
# Methionine.Sulfoxide        -0.44591465  0.327922453  0.374126834  0.221712985  0.133701094
# Methylhistidine              0.57309615 -0.146598522 -0.347829672 -0.001310212  0.004399671
# N_N_Dimethylglycine          0.47781562 -0.407276808 -0.208684617  0.093502201  0.081445187
# Nicotinurate                 0.58378812  0.158827553 -0.027868006  0.120474029  0.020437307
# O.Acetylcarnitine            0.50739689 -0.320336997 -0.040759882 -0.014096372 -0.028078339
# O.Phosphocholine             0.75110500  0.245960325 -0.150222466 -0.125698206  0.013546975
# Ornithine                    0.75399229  0.238144159 -0.291771566 -0.036153750  0.063265519
# Trans.Hydroxyproline         0.28633467  0.774058581  0.163640046 -0.035766985 -0.104135019
# Tryptophan                   0.38244366  0.695256858  0.330935339  0.236578888  0.003443571
# Tyrosine                     0.47616930  0.490476625  0.095164334  0.277104963  0.156042308
# Uridine                      0.23889881  0.168978071  0.288104473 -0.033248056 -0.074361339
# Xanthine                     0.76108961 -0.113589789 -0.280043687 -0.091677009  0.081832496
# Valine                       0.44340228  0.791567172  0.106702937  0.131082355 -0.033465076
# X1.Methylhistidine           0.55583476 -0.110288709 -0.184958537 -0.058507025 -0.054263757
# X2.Hydroxybutyrate           0.13063662  0.382466142  0.249411204  0.160622833 -0.166846022
# X3.Hydroxybutyrate           0.12370092 -0.197500804  0.587255812  0.463074713 -0.255419324
# X14.1SMOH                    0.49921979 -0.087957485  0.402594413 -0.280349701  0.022783081
# X16.1SM                      0.54797021  0.197810718  0.385400396 -0.139527929 -0.154669404
# X16.0SM                      0.53447964  0.241881624  0.434178761 -0.231558330 -0.112959403
# X16.1SMOH                    0.26810413  0.263789427  0.339257206 -0.334731175 -0.266498227
# X18.0SM                      0.68390586 -0.281950542  0.052691605 -0.002059448  0.425689703
# X18.1SM                      0.74547557  0.073055690  0.219677742 -0.160450771  0.333159239
# X20.2SM                      0.13950875 -0.067288300 -0.073485277  0.027499441  0.116741590
# X22.2SMOH                    0.19839255  0.196592998  0.745172079 -0.269961272 -0.142963995
# X22.1SMOH                    0.43199635  0.130516391  0.706459441 -0.283443449  0.131534626
# X24.1SMOH                    0.42760162 -0.415090953  0.384854828 -0.177818473  0.400312375
var$contrib
# C3                          0.561816628 2.064189e+00 3.860267e-01 8.171645e-03 8.409616e-02
# C4_1                        1.129253750 2.480014e-02 2.265417e-01 1.010050e+00 7.172032e-01
# C4                          0.188139749 4.420454e-01 1.947185e+00 4.282664e-01 9.032727e-01
# C3OH                        0.922699383 1.478904e-02 1.188050e+00 2.464279e-01 1.785154e-02
# C5_1                        1.626344966 1.782862e-02 6.892940e-03 1.141148e+00 1.595053e+00
# C5                          0.075794553 2.217171e+00 9.126484e-01 1.554759e-02 8.191300e-01
# C4OH                        0.059184056 8.145316e-02 1.581289e+00 7.300665e-01 5.241873e-01
# C6_1                        1.371174949 8.743443e-02 1.271389e-02 1.715639e+00 2.049369e+00
# C6                          1.441372693 1.648733e-01 6.816514e-04 6.858114e-01 2.458476e+00
# C5OH                        0.415270474 1.907378e-03 1.055447e-01 3.912421e-04 3.354655e-02
# C5_1DC                      0.238651311 3.023280e-02 1.219592e+00 7.752666e-02 3.781920e+00
# C5DC                        0.426168488 1.039508e-01 5.205321e-01 1.956563e-02 3.494214e+00
# C8                          0.187452536 6.797323e-01 1.411592e+00 1.315321e+00 1.301770e+00
# C5MDC                       1.619514604 3.550433e-01 3.899942e-02 1.473812e-01 1.162224e+00
# C9                          1.713863551 3.590047e-01 1.206728e-03 9.702887e-02 1.434483e+00
# C7DC                        0.076122923 1.503898e-02 7.779437e-02 8.481120e-02 8.482003e-04
# Creatine                    0.055331614 3.568428e-01 1.536048e+00 3.484922e-02 1.092489e+00
# Choline                     0.042746647 4.767428e-01 1.599845e-01 2.153039e-01 2.759522e+00
# Citrate                     0.130566106 2.171111e-01 2.472745e+00 1.058179e+00 4.274015e-01
# Creatine.Phosphate          0.016538167 2.208881e-01 8.464784e-02 4.850514e-02 1.280452e-01
# Citrulline                  0.041619117 3.036448e-01 2.566170e-03 2.893886e-01 8.792555e-05
# Cytidine                    1.206912413 1.234611e-02 2.420225e-01 1.159400e-02 4.135893e-01
# Dimethyl.Sulfone            0.775546385 2.881747e-01 9.897496e-01 8.590929e-03 8.338105e-01
# Ethanol                     0.035261186 6.027664e-02 5.219789e-04 8.630980e-01 3.143628e-02
# Ethanolamine                0.021636548 6.065794e-01 2.004048e-01 5.808799e-02 7.774320e-01
# Formate                     0.239279734 1.767270e-02 3.748446e-01 1.158970e+00 2.685819e-01
# Glucose                     0.165717805 7.162929e-01 2.752759e-03 2.591377e-01 1.051907e+00
# Glutamine                   1.110456629 5.394010e-01 7.289758e-03 1.477198e-01 2.147439e-01
# Glutamate                   1.542395315 1.088141e-01 1.163958e-01 6.584733e-01 7.890541e-01
# Glycerol                    0.475306167 2.517013e-02 1.328959e-01 2.030560e-02 4.634110e-02
# Glycine                     0.748550433 2.082290e-01 7.484517e-02 1.522175e+00 1.385712e-01
# Guanidoacetate              1.353467592 1.220255e-03 6.370172e-01 7.508121e-02 2.006264e-01
# Guanosine                   0.915440132 5.863678e-01 1.318565e-01 5.937853e-01 7.593949e-05
# Hypoxanthine                1.519253289 9.063083e-04 5.284757e-01 5.103600e-05 2.230096e-01
# Hypoxanthine                1.519253289 9.063083e-04 5.284757e-01 5.103600e-05 2.230096e-01
# IMP                         1.503045066 2.859166e-01 5.115267e-01 1.595119e-01 3.815792e-01
# Inosine                     1.085925668 7.207874e-02 1.360429e-01 3.887066e-01 1.241985e-01
# Histidine                   0.967472582 1.549069e+00 6.375738e-02 3.129698e-02 1.269274e-01
# Isobutyrate                 0.732057899 1.853146e+00 1.593360e-02 9.614451e-02 7.700558e-02
# Isoleucine                  0.489002530 3.290878e+00 7.380007e-02 3.114618e-01 3.830332e-03
# Isopropanol                 0.038460030 6.301202e-02 1.252261e-04 9.973373e-01 6.718645e-02
# Lactate                     0.095300041 8.878472e-01 9.066479e-01 2.248478e-01 9.480979e-02
# Kynurenine                  0.080973335 5.415255e-01 8.348298e-01 1.908978e-01 4.033547e-02
# Lysine                      1.828077669 5.660330e-01 5.110494e-01 2.490588e-04 9.869969e-02
# Leucine                     0.788824097 2.664894e+00 2.798339e-04 9.162026e-02 6.380604e-02
# LYSOC14.0                   0.014609518 6.705425e-01 9.804997e-01 3.227036e+00 2.870588e-01
# LYSOC16.1                   0.057981744 3.466491e-01 1.319196e+00 1.165868e+00 9.138005e-01
# LYSOC16.0                   0.051536571 8.070914e-01 3.479404e-01 3.009025e+00 5.010750e-01
# LYSOC17.0                   0.005528690 1.024764e+00 1.350899e+00 2.809705e+00 5.493345e-01
# LYSOC18.2                   0.926706971 3.920760e-02 3.977791e-01 6.607191e-01 2.096698e+00
# LYSOC18.1                   0.665690188 3.665492e-01 6.890652e-01 7.208410e-01 2.424743e+00
# LYSOC18.0                   0.491550931 1.378116e-01 7.293200e-01 3.640441e-01 2.736871e+00
# LYSOC20.4                   0.393524604 8.128695e-01 5.958003e-01 4.089011e-02 4.771534e-01
# LYSOC20.3                   0.382262537 1.991957e-02 4.049791e-01 2.542751e-02 3.306753e-01
# LYSOC24.0                   0.275384563 4.249647e-01 1.373945e+00 1.097159e+00 1.513181e-01
# LYSOC26.1                   0.049071923 2.765331e-01 1.378683e+00 3.084319e+00 2.147643e-01
# LYSOC26.0                   0.082227817 6.954607e-01 5.298319e-01 3.727829e+00 2.393377e-01
# LYSOC28.1                   0.056833509 4.811566e-02 3.285950e+00 1.558700e+00 6.158225e-02
# LYSOC28.0                   0.088667236 5.372478e-01 8.842812e-01 3.326661e+00 4.011807e-02
# PC32.2AA                    0.237564725 7.652603e-01 4.273871e-01 1.071784e-01 3.728715e+00
# PC32.2AA                    0.237564725 7.652603e-01 4.273871e-01 1.071784e-01 3.728715e+00
# PC36.0AE                    0.196200839 7.230800e-01 3.136197e+00 1.480724e-01 2.365311e-02
# PC36.6AA                    0.308465899 2.020147e-02 1.744824e+00 2.034682e-01 3.103032e+00
# PC36.0AA                    0.071016175 1.425777e+00 1.582548e+00 3.876842e-01 2.863627e-01
# PC38.6AA                    0.052991974 2.345149e-01 2.087897e+00 8.218121e-03 3.255130e+00
# PC38.0AA                    0.163454438 2.228992e-01 3.799892e+00 2.730748e-03 2.460792e-02
# PC40.6AE                    0.016970987 2.293750e-01 2.923681e+00 2.760752e-02 1.897379e+00
# PC40.6AA                    0.467946580 1.045401e-01 5.777479e-01 1.582383e-01 4.423877e+00
# PC40.2AA                    0.127357309 2.165821e-01 2.492888e+00 3.017443e+00 2.406401e-01
# PC40.1AA                    0.078864812 3.439194e-01 2.586729e+00 9.920075e-01 1.087068e+00
# Phenylalanine               0.781162404 2.529466e+00 7.987003e-03 5.491768e-01 5.722796e-01
# Proline                     0.881015422 2.739651e+00 2.310060e-02 1.235844e-01 9.176804e-03
# Propylene.glycol            0.011359847 1.605942e+00 1.075963e-01 3.945641e-02 1.085160e+00
# Putrescine                  0.001688733 7.158240e-01 1.215655e+00 6.212228e-02 2.193930e-02
# Pyruvate                    0.717078550 7.852140e-02 7.623321e-01 1.403879e+00 9.307395e-01
# Sarcosine                   0.256840261 3.458554e-01 5.512764e-02 1.021447e+00 6.865203e-01
# Serine                      0.402410821 2.461342e-03 9.824804e-02 2.289571e+00 2.193363e+00
# sn.Glycero.3.phosphocholine 1.401906844 4.465346e-01 5.468566e-01 2.251214e-02 4.865382e-01
# Spermidine                  0.255453508 7.387323e-01 3.738818e-01 8.559534e-02 1.496126e-02
# Spermine                    0.117051002 2.982064e-01 2.494248e+00 9.916826e-02 1.089405e-04
# Succinate                   0.044128588 2.056601e-05 2.766956e-02 1.332560e+00 1.669306e+00        
# Spermidine                  0.255453508 7.387323e-01 3.738818e-01 8.559534e-02 1.496126e-02
# Spermine                    0.117051002 2.982064e-01 2.494248e+00 9.916826e-02 1.089405e-04
# Succinate                   0.044128588 2.056601e-05 2.766956e-02 1.332560e+00 1.669306e+00
# Taurine                     1.780062465 2.149974e-02 2.387282e-01 3.160832e-01 5.048859e-02
# Threonine                   0.973062182 5.062317e-01 1.049024e-01 5.145687e-01 4.578314e-01
# Total.Dimethylarginine      1.103691298 1.212760e+00 1.548083e-01 1.377069e-01 1.067036e-04
# Threonine.1                 0.973062182 5.062317e-01 1.049024e-01 5.145687e-01 4.578314e-01
# Malate                      1.729015751 1.782683e-02 2.645347e-01 1.416138e-01 4.654362e-01
# Malonate                    1.412303805 3.475335e-02 5.782531e-05 1.086816e+00 3.936834e-01
# Mannose                     1.258013818 2.827827e-01 6.857144e-01 6.440354e-02 3.125115e-03
# Methanol                    1.023393400 2.634772e-05 7.006630e-01 1.115385e-01 4.041881e-01
# Methionine                  1.483471779 1.005599e+00 2.774200e-02 1.455154e-01 2.167075e-01
# Methionine.Sulfoxide        0.551393175 5.816287e-01 7.768979e-01 5.626268e-01 2.190769e-01
# Methylhistidine             0.910778747 1.162419e-01 6.715208e-01 1.964812e-05 2.372285e-04
# N_N_Dimethylglycine         0.633109170 8.971868e-01 2.417169e-01 1.000649e-01 8.129380e-02
# Nicotinurate                0.945079670 1.364442e-01 4.310603e-03 1.661212e-01 5.118868e-03
# O.Acetylcarnitine           0.713926512 5.550316e-01 9.221298e-03 2.274327e-03 9.662053e-03
# O.Phosphocholine            1.564441096 3.272153e-01 1.252553e-01 1.808408e-01 2.249113e-03
# Ornithine                   1.576491820 3.067492e-01 4.725113e-01 1.496046e-02 4.905245e-02
# Trans.Hydroxyproline        0.227355661 3.240792e+00 1.486296e-01 1.464208e-02 1.328985e-01
# Tryptophan                  0.405595237 2.614533e+00 6.078725e-01 6.406047e-01 1.453265e-04
# Tyrosine                    0.628753890 1.301188e+00 5.026604e-02 8.788743e-01 2.984086e-01
# Uridine                     0.158265370 1.544416e-01 4.607085e-01 1.265233e-02 6.776742e-02
# Xanthine                    1.606310512 6.978822e-02 4.352891e-01 9.619644e-02 8.206882e-02
# Valine                      0.545197364 3.389059e+00 6.319446e-02 1.966648e-01 1.372493e-02
# X1.Methylhistidine          0.856740546 6.579087e-02 1.898781e-01 3.917907e-02 3.608663e-02
# X2.Hydroxybutyrate          0.047324689 7.912059e-01 3.452694e-01 2.952927e-01 3.411601e-01
# X3.Hydroxybutyrate          0.042433002 2.109800e-01 1.914172e+00 2.454371e+00 7.995287e-01
# X14.1SMOH                   0.691100971 4.184554e-02 8.996254e-01 8.995770e-01 6.361382e-03
# X16.1SM                     0.832667873 2.116426e-01 8.244238e-01 2.228232e-01 2.931807e-01
# X16.0SM                     0.792173373 3.164530e-01 1.046317e+00 6.137040e-01 1.563765e-01
# X16.1SMOH                   0.199326448 3.763729e-01 6.388287e-01 1.282421e+00 8.703927e-01
# X18.0SM                     1.297031593 4.299811e-01 1.541023e-02 4.854449e-05 2.220817e+00
# X18.1SM                     1.541078442 2.886766e-02 2.678541e-01 2.946604e-01 1.360286e+00
# X20.2SM                     0.053971039 2.448965e-02 2.997277e-02 8.655375e-03 1.670236e-01
# X22.2SMOH                   0.109146199 2.090449e-01 3.082048e+00 8.341441e-01 2.504840e-01
# X22.1SMOH                   0.517509176 9.213691e-02 2.770133e+00 9.195408e-01 2.120346e-01
# X24.1SMOH                   0.507033427 9.319445e-01 8.220914e-01 3.619028e-01 1.963924e+00
var$cos2
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# Creatinine                  0.0246518184 2.569509e-02 2.024012e-01 6.272404e-04 7.418247e-02
# Acetamide                   0.1999684786 6.145930e-02 1.306678e-01 3.999752e-03 1.399283e-02
# Acetate                     0.0196589846 5.585977e-03 2.104787e-01 2.053506e-02 4.451386e-04
# Acetoacetate                0.0214307673 1.400992e-02 1.380209e-02 1.936571e-03 4.258546e-02
# Acetone                     0.4297048849 4.668081e-02 6.428601e-05 3.603884e-02 1.193156e-03
# Acetyl.Ornithine            0.0330610417 1.442391e-01 8.003330e-02 5.646442e-03 3.832992e-04
# Adenosine                   0.3229985499 8.568444e-03 5.586351e-02 4.014257e-02 2.427938e-05
# ADP                         0.0044621915 1.933073e-01 3.671043e-02 1.304952e-05 3.503116e-02
# AMP                         0.2599160090 5.374617e-02 1.105632e-03 2.241721e-01 4.352933e-02
# ATP                         0.0196601606 8.541887e-02 6.246481e-02 1.615892e-02 3.680806e-03
# Alanine                     0.4202142685 4.263071e-02 9.191412e-03 1.399769e-02 6.046882e-02
# Alpha.Aminoadipic.Acid      0.0221175432 8.419747e-02 6.883563e-02 6.716150e-02 1.689502e-02
# Arginine                    0.6931960394 2.835616e-03 8.744365e-02 6.032267e-05 2.502321e-02
# Asparagine                  0.0096301445 4.983686e-01 9.746064e-02 6.427578e-04 1.222288e-02
# Aspartate                   0.3696551149 1.105769e-01 3.403093e-02 3.521543e-02 3.048051e-02
# Asymmetric.Dimethylarginine 0.4645548730 2.454337e-01 3.269172e-03 2.545352e-04 1.762434e-04
# Beta.Alanine                0.2842983503 7.988594e-03 4.753811e-02 1.444600e-03 1.001434e-02
# Beta.Hydroxybutyrate        0.0155983654 3.009980e-02 3.653872e-01 2.030352e-01 5.992702e-02
# Betaine                     0.1610919648 1.239029e-03 5.904887e-02 3.885465e-03 3.917906e-02
# Carnitine                   0.3807926315 9.510194e-02 5.740883e-04 1.318159e-03 7.869477e-04
# C10                         0.4409689885 6.292645e-02 5.349714e-03 8.003525e-03 1.451222e-01
# C10.2                       0.4791691211 4.224627e-02 1.160142e-02 8.349835e-02 7.975102e-02
# C10.1                       0.3421142732 5.154523e-04 6.568284e-02 1.268502e-01 4.815614e-02
# C12.1                       0.0005549055 1.995326e-01 2.644760e-01 6.725482e-02 1.679463e-01
# C12                         0.3673348491 1.057617e-01 1.429554e-02 7.046424e-02 4.736716e-04
# C12DC                       0.0543639158 5.845301e-02 1.778892e-02 4.176248e-03 1.174269e-01
# C14.2                       0.5647308943 1.291136e-01 3.232862e-03 4.736825e-04 9.917467e-02
# C14.1                       0.0056714133 2.951532e-01 3.211285e-01 1.990216e-01 2.563423e-02
# C14                         0.2397246380 2.768142e-01 7.293423e-02 1.704417e-01 1.912395e-02
# C14.2OH                     0.6389648374 2.352108e-01 6.675028e-05 2.399889e-02 2.607334e-02
# C14.1OH                     0.2876853009 3.404100e-01 9.739125e-02 1.185388e-01 5.464664e-02
# C16.2                       0.7162427379 9.670204e-02 2.517357e-02 1.474153e-03 2.445313e-02
# C16.1                       0.1159607998 4.440142e-01 8.855765e-02 2.328334e-01 2.950541e-03
# C16                         0.0805687852 4.214683e-01 1.070051e-01 2.100845e-01 5.191648e-03
# C16.2OH                     0.5629128969 2.565896e-01 8.970196e-03 3.033511e-02 5.715044e-02
# C16                         0.0805687852 4.214683e-01 1.070051e-01 2.100845e-01 5.191648e-03
# C16.2OH                     0.5629128969 2.565896e-01 8.970196e-03 3.033511e-02 5.715044e-02
# C16.1OH                     0.2735687591 3.746842e-01 1.094345e-01 8.475552e-02 2.521078e-02
# C16OH                       0.1899252197 1.263453e-01 2.481212e-02 6.176274e-02 5.167840e-02
# C18_2                       0.6425959753 2.401867e-01 2.426999e-05 4.091267e-02 1.236298e-02
# C18_1                       0.1117617174 4.485127e-01 1.058194e-01 2.275972e-01 1.255741e-03
# C18                         0.1569979671 3.183319e-01 2.863788e-02 1.682468e-01 5.732425e-03
# C18_1OH                     0.3987796354 2.850164e-01 5.364914e-02 3.306273e-02 5.759618e-02
# C2                          0.0208669389 1.027185e-01 1.363159e-01 1.041127e-01 1.216826e-02
# C3_1                        0.0132635846 3.791337e-03 3.084083e-01 2.857261e-02 1.463768e-01
# C3                          0.2025987116 3.816329e-01 6.954904e-02 7.139559e-04 6.861982e-03
# C4_1                        0.4072242498 4.585119e-03 4.081521e-02 8.824800e-02 5.852152e-02
# C4                          0.0678457506 8.172658e-02 3.508173e-01 3.741760e-02 7.370421e-02
# C3OH                        0.3327379380 2.734239e-03 2.140466e-01 2.153038e-02 1.456629e-03
# C5_1                        0.5864820983 3.296206e-03 1.241876e-03 9.970197e-02 1.301513e-01
# C5                          0.0273325460 4.099167e-01 1.644286e-01 1.358391e-03 6.683843e-02
# C4OH                        0.0213425750 1.505929e-02 2.848952e-01 6.378584e-02 4.277203e-02
# C6_1                        0.4944643220 1.616512e-02 2.290616e-03 1.498952e-01 1.672221e-01
# C6                          0.5197785826 3.048224e-02 1.228107e-04 5.991928e-02 2.006039e-01
# C5OH                        0.1497521768 3.526413e-04 1.901561e-02 3.418278e-05 2.737293e-03
# C5_1DC                      0.0860609064 5.589524e-03 2.197296e-01 6.773497e-03 3.085928e-01
# C6                          0.5197785826 3.048224e-02 1.228107e-04 5.991928e-02 2.006039e-01
# C5OH                        0.1497521768 3.526413e-04 1.901561e-02 3.418278e-05 2.737293e-03
# C5_1DC                      0.0860609064 5.589524e-03 2.197296e-01 6.773497e-03 3.085928e-01
# C5DC                        0.1536821489 1.921871e-02 9.378238e-02 1.709447e-03 2.851169e-01
# C8                          0.0675979322 1.256708e-01 2.543214e-01 1.149195e-01 1.062203e-01
# C5MDC                       0.5840189768 6.564140e-02 7.026385e-03 1.287668e-02 9.483380e-02
# C9                          0.6180424892 6.637380e-02 2.174118e-04 8.477403e-03 1.170493e-01
# C7DC                        0.0274509605 2.780449e-03 1.401593e-02 7.409946e-03 6.921048e-05
# Creatine                    0.0199533321 6.597410e-02 2.767442e-01 3.044773e-03 8.914364e-02
# Choline                     0.0154150218 8.814153e-02 2.882384e-02 1.881108e-02 2.251683e-01
# Citrate                     0.0470839124 4.014010e-02 4.455056e-01 9.245298e-02 3.487462e-02
# Creatine.Phosphate          0.0059638877 4.083840e-02 1.525070e-02 4.237889e-03 1.044809e-02
# Citrulline                  0.0150084193 5.613869e-02 4.623376e-04 2.528385e-02 7.174448e-06
# Cytidine                    0.4352290191 2.282584e-03 4.360432e-02 1.012967e-03 3.374759e-02
# Dimethyl.Sulfone            0.2796725669 5.327854e-02 1.783196e-01 7.505886e-04 6.803631e-02
# Ethanol                     0.0127156631 1.114411e-02 9.404305e-05 7.540879e-02 2.565101e-03
# Ethanolamine                0.0078024331 1.121461e-01 3.610621e-02 5.075142e-03 6.343600e-02
# Formate                     0.0862875242 3.267378e-03 6.753440e-02 1.012591e-01 2.191544e-02
# Glucose                     0.0597600929 1.324302e-01 4.959546e-04 2.264084e-02 8.583231e-02
# Glutamine                   0.4004457523 9.972597e-02 1.313369e-03 1.290627e-02 1.752243e-02
# Glutamate                   0.5562087129 2.011785e-02 2.097062e-02 5.753075e-02 6.438433e-02
# Glycerol                    0.1714018636 4.653524e-03 2.394338e-02 1.774098e-03 3.781288e-03
# Glycine                     0.2699374597 3.849795e-02 1.348458e-02 1.329923e-01 1.130698e-02
# Guanidoacetate              0.4880788085 2.256041e-04 1.147691e-01 6.559839e-03 1.637048e-02
# Guanosine                   0.3301201532 1.084093e-01 2.375610e-02 5.187897e-02 6.196423e-06
# Hypoxanthine                0.5478633839 1.675608e-04 9.521356e-02 4.459011e-06 1.819688e-02
# IMP                         0.5420184785 5.286105e-02 9.215991e-02 1.393654e-02 3.113566e-02
# Inosine                     0.3915995546 1.332612e-02 2.451036e-02 3.396126e-02 1.013421e-02
# IMP                         0.5420184785 5.286105e-02 9.215991e-02 1.393654e-02 3.113566e-02
# Inosine                     0.3915995546 1.332612e-02 2.451036e-02 3.396126e-02 1.013421e-02
# Histidine                   0.3488837619 2.863962e-01 1.148694e-02 2.734414e-03 1.035687e-02
# Isobutyrate                 0.2639900278 3.426149e-01 2.870699e-03 8.400137e-03 6.283413e-03
# Isoleucine                  0.1763409582 6.084267e-01 1.329629e-02 2.721238e-02 3.125430e-04
# Isopropanol                 0.0138692095 1.164984e-02 2.256154e-05 8.713727e-02 5.482203e-03
# Lactate                     0.0343664898 1.641477e-01 1.633475e-01 1.964493e-02 7.736180e-03
# Kynurenine                  0.0292000852 1.001188e-01 1.504083e-01 1.667872e-02 3.291247e-03
# Lysine                      0.6592296526 1.046498e-01 9.207393e-02 2.176025e-05 8.053584e-03
# Leucine                     0.2844606900 4.926931e-01 5.041666e-05 8.004854e-03 5.206372e-03
# LYSOC14.0                   0.0052683907 1.239718e-01 1.766531e-01 2.819458e-01 2.342309e-02
# LYSOC16.1                   0.0209090048 6.408945e-02 2.376748e-01 1.018618e-01 7.456325e-02
# LYSOC16.0                   0.0185847879 1.492173e-01 6.268716e-02 2.628983e-01 4.088614e-02
# LYSOC17.0                   0.0019937208 1.894611e-01 2.433866e-01 2.454836e-01 4.482397e-02
# LYSOC18.2                   0.3341831284 7.248811e-03 7.166643e-02 5.772696e-02 1.710840e-01
# LYSOC18.1                   0.2400569289 6.776864e-02 1.241464e-01 6.297981e-02 1.978514e-01
# LYSOC18.0                   0.1772599465 2.547899e-02 1.313989e-01 3.180650e-02 2.233201e-01
# LYSOC20.4                   0.1419103204 1.502856e-01 1.073432e-01 3.572565e-03 3.893422e-02
# LYSOC20.3                   0.1378490661 3.682786e-03 7.296362e-02 2.221599e-03 2.698207e-02
# LYSOC24.0                   0.0993074161 7.856866e-02 2.475387e-01 9.585866e-02 1.234708e-02
# LYSOC26.1                   0.0176960025 5.112622e-02 2.483923e-01 2.694767e-01 1.752409e-02
# LYSOC26.0                   0.0296524685 1.285787e-01 9.545790e-02 3.257001e-01 1.952921e-02
# LYSOC28.1                   0.0204949357 8.895758e-03 5.920178e-01 1.361835e-01 5.024918e-03
# LYSOC28.0                   0.0319746104 9.932787e-02 1.593177e-01 2.906501e-01 3.273508e-03
# PC32.2AA                    0.0856690685 1.414834e-01 7.700079e-02 9.364167e-03 3.042514e-01
# PC32.2AA                    0.0856690685 1.414834e-01 7.700079e-02 9.364167e-03 3.042514e-01
# PC36.0AE                    0.0707526891 1.336850e-01 5.650373e-01 1.293707e-02 1.930020e-03
# PC36.6AA                    0.1112369955 3.734904e-03 3.143586e-01 1.777699e-02 2.531976e-01
# PC36.0AA                    0.0256093980 2.636016e-01 2.851219e-01 3.387193e-02 2.336629e-02
# PC38.6AA                    0.0191096260 4.335776e-02 3.761689e-01 7.180164e-04 2.656084e-01
# PC38.0AA                    0.0589438919 4.121022e-02 6.846129e-01 2.385851e-04 2.007929e-03
# PC40.6AE                    0.0061199685 4.240750e-02 5.267491e-01 2.412066e-03 1.548202e-01
# PC40.6AA                    0.1687478966 1.932767e-02 1.040907e-01 1.382527e-02 3.609744e-01
# PC40.2AA                    0.0459267766 4.004230e-02 4.491346e-01 2.636337e-01 1.963548e-02
# PC40.1AA                    0.0284397231 6.358477e-02 4.660416e-01 8.667160e-02 8.870129e-02
# Phenylalanine               0.2816977795 4.676547e-01 1.438990e-03 4.798153e-02 4.669622e-02
# Proline                     0.3177061350 5.065143e-01 4.161952e-03 1.079756e-02 7.487983e-04
# Propylene.glycol            0.0040965151 2.969110e-01 1.938524e-02 3.447302e-03 8.854562e-02
# Putrescine                  0.0006089801 1.323435e-01 2.190202e-01 5.427618e-03 1.790177e-03
# Pyruvate                    0.2585882707 1.451725e-02 1.373466e-01 1.226568e-01 7.594542e-02
# Sarcosine                   0.0926200888 6.394272e-02 9.932148e-03 8.924371e-02 5.601790e-02
# Serine                      0.1451148112 4.550598e-04 1.770099e-02 2.000396e-01 1.789715e-01
# sn.Glycero.3.phosphocholine 0.5055466610 8.255656e-02 9.852517e-02 1.966884e-03 3.969999e-02
# Spermidine                  0.0921200069 1.365789e-01 6.736094e-02 7.478456e-03 1.220791e-03
# Spermine                    0.0422101823 5.513323e-02 4.493796e-01 8.664321e-03 8.889202e-06
# Succinate                   0.0159133685 3.802301e-06 4.985125e-03 1.164256e-01 1.362101e-01
# Taurine                     0.6419147175 3.974933e-03 4.301079e-02 2.761616e-02 4.119710e-03
# Taurine                     0.6419147175 3.974933e-03 4.301079e-02 2.761616e-02 4.119710e-03
# Threonine                   0.3508994475 9.359353e-02 1.889988e-02 4.495781e-02 3.735760e-02
# Total.Dimethylarginine      0.3980060821 2.242184e-01 2.789125e-02 1.203144e-02 8.706677e-06
# Threonine.1                 0.3508994475 9.359353e-02 1.889988e-02 4.495781e-02 3.735760e-02
# Malate                      0.6235065785 3.295875e-03 4.766026e-02 1.237278e-02 3.797813e-02
# Malonate                    0.5092959466 6.425296e-03 1.041818e-05 9.495498e-02 3.212333e-02
# Mannose                     0.4536568804 5.228165e-02 1.235427e-01 5.626931e-03 2.549995e-04
# Methanol                    0.3690495687 4.871239e-06 1.262359e-01 9.745107e-03 3.298048e-02
# Methionine                  0.5349600854 1.859180e-01 4.998176e-03 1.271367e-02 1.768265e-02
# Methionine.Sulfoxide        0.1988398729 1.075331e-01 1.399709e-01 4.915665e-02 1.787598e-02
# Methylhistidine             0.3284391944 2.149113e-02 1.209855e-01 1.716655e-06 1.935710e-05
# N_N_Dimethylglycine         0.2283077714 1.658744e-01 4.354927e-02 8.742662e-03 6.633318e-03
# Nicotinurate                0.3408085735 2.522619e-02 7.766258e-04 1.451399e-02 4.176835e-04
# O.Acetylcarnitine           0.2574516031 1.026158e-01 1.661368e-03 1.987077e-04 7.883931e-04
# O.Phosphocholine            0.5641587214 6.049648e-02 2.256679e-02 1.580004e-02 1.835205e-04
# Ornithine                   0.5685043761 5.671264e-02 8.513065e-02 1.307094e-03 4.002526e-03
# Trans.Hydroxyproline        0.0819875414 5.991667e-01 2.677806e-02 1.279277e-03 1.084410e-02
# Tryptophan                  0.1462631549 4.833821e-01 1.095182e-01 5.596957e-02 1.185818e-05
# Tyrosine                    0.2267371979 2.405673e-01 9.056250e-03 7.678716e-02 2.434920e-02
# Uridine                     0.0570726433 2.855359e-02 8.300419e-02 1.105433e-03 5.529609e-03
# Xanthine                    0.5792574017 1.290264e-02 7.842447e-02 8.404674e-03 6.696557e-03
# Valine                      0.1966055792 6.265786e-01 1.138552e-02 1.718258e-02 1.119911e-03
# X1.Methylhistidine          0.3089522848 1.216360e-02 3.420966e-02 3.423072e-03 2.944555e-03
# X2.Hydroxybutyrate          0.0170659262 1.462803e-01 6.220595e-02 2.579969e-02 2.783760e-02
# X3.Hydroxybutyrate          0.0153019172 3.900657e-02 3.448694e-01 2.144382e-01 6.523903e-02
# X14.1SMOH                   0.2492204028 7.736519e-03 1.620823e-01 7.859595e-02 5.190688e-04
# X16.1SM                     0.3002713517 3.912908e-02 1.485335e-01 1.946804e-02 2.392262e-02
# X16.0SM                     0.2856684845 5.850672e-02 1.885112e-01 5.361926e-02 1.275983e-02
# X16.1SMOH                   0.0718798261 6.958486e-02 1.150955e-01 1.120450e-01 7.102130e-02
# X18.0SM                     0.4677272202 7.949611e-02 2.776405e-03 4.241327e-06 1.812117e-01
# X18.1SM                     0.5557338306 5.337134e-03 4.825831e-02 2.574445e-02 1.109951e-01
# X20.2SM                     0.0194626901 4.527715e-03 5.400086e-03 7.562193e-04 1.362860e-02
# X22.2SMOH                   0.0393596029 3.864881e-02 5.552814e-01 7.287909e-02 2.043870e-02
# X22.1SMOH                   0.1866208423 1.703453e-02 4.990849e-01 8.034019e-02 1.730136e-02
# X24.1SMOH                   0.1828431449 1.723005e-01 1.481132e-01 3.161941e-02 1.602500e-01

#### graph of variables default plot ####
fviz_pca_var(DM_pca_FM, col.var = "black")
# plot aka variable correlation plot
# positively correlated: variables grouped together 
# negatively correlated: variables positioned on opposite sides of the origin (opposed quadrants)
# distance between variables and the origin measures the quality of the variables on the factor map. 
# variables that are away from the origin are well represented on the factor map
fviz_pca_var(DM_pca_FM, col.var = "black", axes = c(2,3))
fviz_pca_var(DM_pca_FM, col.var = "black", axes = c(3,4))
fviz_pca_var(DM_pca_FM, col.var = "black", axes = c(4,5))


#### Quality of representation ####
#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.

head(var$contrib) # contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.
# visualize cos2 as bar graph
fviz_cos2(DM_pca_FM, choice = "var", axes = 1:2)

# Color by cos2 values: quality on the factor map
fviz_pca_var(DM_pca_FM, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)

variables_PCA<- fviz_pca_var(DM_pca_FM, col.var = "cos2",
                             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
                             repel = TRUE # Avoid text overlapping
)

# Adjust transparancy by cos2 values: quality on the factor map
fviz_pca_var(DM_pca_FM, alpha.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE # Avoid text overlapping
)


#### Contributions of variables to PCs ####

# contributions of variables in a given principal component are expressed in percentage.
# Variables that are correlated with PC1 and PC2 are the most important in explaining the variability in the data set.
# Variables that do not correlate with any PC or correlate with the last dimensions are variables with 
# low contribution and might be removed to simplify the overall analysis.

head(var$contrib) # contributions of variables to the PCs
# The larger the value of the contribution, the more the variable contributes to the component.

# visualize contributions as corrplot
# pdf("PCA/contrib_corrplot.pdf", height = 7, width = 3.25)
corrplot(var$contrib, is.corr=FALSE,
         tl.col = "black", tl.cex = 1, 
         cl.cex = 1, cl.align.text = "l", cl.ratio = 0.75,
         mar = c(1, 1, 1, 1)
)  

# Barplot of contributions to a component
# The red dashed line on the graph above indicates the expected average contribution. 
# If the contribution of the variables were uniform, the expected value would be 1/length(variables) = 1/32 = 3.125%.
# For a given component, a variable with a contribution larger than this cutoff 
# could be considered as important in contributing to the component.

#### contributions of variables ####
# to PC1
contrib_PC1 <- fviz_contrib(DM_pca_FM, choice = "var", axes = 1, top = 50,
                            fill = "#6baed6", color = "#2171b5",
                            title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 7.5, x = 19, label = expression(bold("PC1")), size = 5)
contrib_PC1
ggsave("contrib_PC1.pdf")
# contributions of variables to PC2
contrib_PC2 <- fviz_contrib(DM_pca_FM, choice = "var", axes = 2, top = 40,
                            fill = "#6baed6", color = "#2171b5",
                            title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 8.5, x = 19, label = expression(bold("PC2")), size = 5)
contrib_PC2
ggsave("contrib_PC2.pdf")
# contributions of variables to PC3
contrib_PC3 <- fviz_contrib(DM_pca_FM, choice = "var", axes = 3, top = 40,
                            fill = "#6baed6", color = "#2171b5",
                            title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 10, x = 19, label = expression(bold("PC3")), size = 5)
contrib_PC3
ggsave("contrib_PC3.pdf")
# contributions of variables to PC4

contrib_PC4 <- fviz_contrib(DM_pca_FM, choice = "var", axes = 4, top = 40,
                            fill = "#6baed6", color = "#2171b5",
                            title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 15, x = 19, label = expression(bold("PC4")), size = 5)
contrib_PC4
ggsave("contrib_PC4.pdf")
# contributions of variables to PC5
contrib_PC5 <- fviz_contrib(DM_pca_FM, choice = "var", axes = 5, top = 40,
                            fill = "#6baed6", color = "#2171b5",
                            title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 25, x = 19, label = expression(bold("PC5")), size = 5)
contrib_PC5
ggsave("contrib_PC5.pdf")
# contributions of variables to PC1 and PC2
contrib_PC1_PC2 <- fviz_contrib(DM_pca_FM, choice = "var", axes = c(1,2), top = 50,
                                fill = "#6baed6", color = "#2171b5",
                                title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 5, x = 18, label = expression(bold("PC1 & PC2")), size = 5)
contrib_PC1_PC2
ggsave("contrib_PC1_PC2.pdf")
# contributions of variables to PC2 and PC3
contrib_PC2_PC3 <- fviz_contrib(DM_pca_FM, choice = "var", axes = c(2,3), top = 40,
                                fill = "#6baed6", color = "#2171b5",
                                title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 6.5, x = 18, label = expression(bold("PC2 & PC3")), size = 5)
contrib_PC2_PC3

ggsave("contrib_PC2_PC3.pdf")
# contributions of variables to PC3 and PC4
contrib_PC3_PC4 <- fviz_contrib(DM_pca_FM, choice = "var", axes = c(3,4), top = 40,
                                fill = "#6baed6", color = "#2171b5",
                                title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 7.5, x = 18, label = expression(bold("PC3 & PC4")), size = 5)
contrib_PC3_PC4

ggsave("contrib_PC3_PC4.pdf")
# contributions of variables to PC4 and PC5
contrib_PC4_PC5 <- fviz_contrib(DM_pca_FM, choice = "var", axes = c(4,5), top = 40,
                                fill = "#6baed6", color = "#2171b5",
                                title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 13, x = 18, label = expression(bold("PC4 & PC5")), size = 5)
contrib_PC4_PC5
ggsave("contrib_PC4_PC5.pdf")
# contributions of variables to PC1:PC3
contrib_PC1_to_PC3 <- fviz_contrib(DM_pca_FM, choice = "var", axes = c(1:3), top = 40,
                                   fill = "#6baed6", color = "#2171b5",
                                   title = "") +
  theme_classic() +
  theme(axis.text.x = element_text(angle = 90, size = 10, colour = "black"),
        axis.text.y = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold")) +
  theme(aspect.ratio = 1/2) +
  xlab("Metabolite") +
  annotate("text", y = 4.5, x = 18, label = expression(bold("PC1 to PC3")), size = 5)
contrib_PC1_to_PC3
ggsave("contrib_PC1_to_PC3.pdf")
#### colour variable colors using their contributions ####

# PC1 and PC2
varplot_contrib_PC1_PC2 <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                        repel = TRUE,  # avoid text overlapping
                                        title = ""
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))

varplot_contrib_PC1_PC2
ggsave("varplot_contrib_PC1_PC2.pdf")
# PC1 and PC2 select var
varplot_contrib_PC1_PC2_select <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                               gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                               repel = TRUE,  # avoid text overlapping
                                               title = "",
                                               select.var = list(contrib = 60) # keeps only top var
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))

varplot_contrib_PC1_PC2_select
ggsave("varplot_contrib_PC1_PC2_select.pdf")
# PC2 and PC3
varplot_contrib_PC2_PC3 <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                        axes = c(2,3),
                                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                        repel = TRUE,  # avoid text overlapping
                                        title = ""
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC2_PC3
ggsave("varplot_contrib_PC2_PC3")
# PC2 and PC3 select var
varplot_contrib_PC2_PC3_select <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                               axes = c(2,3),
                                               gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                               repel = TRUE,  # avoid text overlapping
                                               title = "",
                                               select.var = list(contrib = 30) # keeps only top var
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC2_PC3_select
ggsave("varplot_contrib_PC2_PC3_select.pdf")
# PC4 and PC3
varplot_contrib_PC4_PC3 <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                        axes = c(3,4),
                                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                        repel = TRUE,  # avoid text overlapping
                                        title = ""
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC4_PC3
ggsave("varplot_contrib_PC4_PC3.pdf")
# PC4 and PC3 select var
varplot_contrib_PC4_PC3_select <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                               axes = c(3,4),
                                               gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                               repel = TRUE,  # avoid text overlapping
                                               title = "",
                                               select.var = list(contrib = 30) # keeps only top var
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC4_PC3_select
ggsave("varplot_contrib_PC4_PC3_select.pdf")
# PC4 and PC5
varplot_contrib_PC4_PC5 <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                        axes = c(4,5),
                                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                        repel = TRUE,  # avoid text overlapping
                                        title = ""
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC4_PC5
ggsave("varplot_contrib_PC4_PC5.pdf")
# PC4 and PC5 select var
varplot_contrib_PC4_PC5_select <- fviz_pca_var(DM_pca_FM, col.var = "contrib",  # colour by contributions to the PC
                                               axes = c(4,5),
                                               gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                                               repel = TRUE,  # avoid text overlapping
                                               title = "",
                                               select.var = list(contrib = 30) # keeps only top var
) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 14, face = "bold"))
varplot_contrib_PC4_PC5_select
ggsave("varplot_contrib_PC4_PC5_select.pdf")
# install the colour brewer
library("RColorBrewer")


#### colour variables by groups ####
# PC1-2
options(ggrepel.max.overlaps = Inf)
varplot_met_PC1_PC2_select <- fviz_pca_var(DM_pca_FM, col.var = met_groups$Category, 
                                           # palette = c("dodgerblue2", "#E31A1C", # red
                                           #             "green4",
                                           #             "#6A3D9A", # purple
                                           #             "#FF7F00", # orange
                                           #             "black", "gold1",
                                           #             "skyblue2", "#FB9A99", # lt pink
                                           #             "palegreen2",
                                           #             "#CAB2D6", # lt purple
                                           #             "#FDBF6F", # lt orange
                                           #             "gray70", "khaki2",
                                           #             "maroon", "orchid1", "deeppink1", "blue1", "steelblue4"),
                                           select.var = list(contrib = 40),
                                           legend.title = "Metabolite function",
                                           title = "",
                                           repel = TRUE) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 13, face = "bold"))
varplot_met_PC1_PC2_select

# PC2-3 select
options(ggrepel.max.overlaps = Inf)
varplot_met_PC3_PC2_select <- fviz_pca_var(DM_pca_FM, col.var = met_groups$Category,
                                           axes = c(2,3),
                                           # palette = c("dodgerblue2", "#E31A1C", # red
                                           #             "green4",
                                           #             "#6A3D9A", # purple
                                           #             "#FF7F00", # orange
                                           #             "black", "gold1",
                                           #             "skyblue2", "#FB9A99", # lt pink
                                           #             "palegreen2",
                                           #             "#CAB2D6", # lt purple
                                           #             "#FDBF6F", # lt orange
                                           #             "gray70", "khaki2",
                                           #             "maroon", "orchid1", "deeppink1", "blue1", "steelblue4"),
                                           select.var = list(contrib = 80),
                                           legend.title = "Metabolite function",
                                           title = "",
                                           repel = TRUE) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 13, face = "bold"))
varplot_met_PC3_PC2_select

# cPC3-4 select
options(ggrepel.max.overlaps = Inf)
varplot_met_PC3_PC4_select <- fviz_pca_var(DM_pca_FM, col.var = met_groups$Category,
                                           axes = c(3,4),
                                           # palette = c("dodgerblue2", "#E31A1C", # red
                                           #             "green4",
                                           #             "#6A3D9A", # purple
                                           #             "#FF7F00", # orange
                                           #             "black", "gold1",
                                           #             "skyblue2", "#FB9A99", # lt pink
                                           #             "palegreen2",
                                           #             "#CAB2D6", # lt purple
                                           #             "#FDBF6F", # lt orange
                                           #             "gray70", "khaki2",
                                           #             "maroon", "orchid1", "deeppink1", "blue1", "steelblue4"),
                                           select.var = list(contrib = 80),
                                           legend.title = "Metabolite function",
                                           title = "",
                                           repel = TRUE) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 13, face = "bold"))
varplot_met_PC3_PC4_select

# PC4-5
options(ggrepel.max.overlaps = Inf)
varplot_met_PC4_PC5_select <- fviz_pca_var(DM_pca_FM, col.var = met_groups$Category,
                                           axes = c(4,5),
                                           # palette = c("dodgerblue2", "#E31A1C", # red
                                           #             "green4",
                                           #             "#6A3D9A", # purple
                                           #             "#FF7F00", # orange
                                           #             "black", "gold1",
                                           #             "skyblue2", "#FB9A99", # lt pink
                                           #             "palegreen2",
                                           #             "#CAB2D6", # lt purple
                                           #             "#FDBF6F", # lt orange
                                           #             "gray70", "khaki2",
                                           #             "maroon", "orchid1", "deeppink1", "blue1", "steelblue4"),
                                           select.var = list(contrib = 80),
                                           legend.title = "Metabolite function",
                                           title = "",
                                           repel = TRUE) +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13),
        axis.title = element_text(size = 13, face = "bold"))
varplot_met_PC4_PC5_select

#### Dimension description ####

# shows the variables that are signficantly correlated to the dimensions (pos or neg)
# (correlation cooeficient is signficantly different from 0)
# by default, the first 3 dimentions are characterized, use "axes =" to set dims

dim.desc <- dimdesc(DM_pca_FM, axes = c(1:5))

dim.desc$Dim.1
# Link between the variable and the continuous variables (R-square)
# =================================================================================
#   correlation      p.value
# C16.2                         0.8463113 1.286277e-34
# Arginine                      0.8325840 1.416161e-32
# Lysine                        0.8119296 7.903377e-30
# C18_2                         0.8016208 1.396638e-28
# Taurine                       0.8011958 1.566500e-28
# C14.2OH                       0.7993528 2.568545e-28
# Malate                        0.7896243 3.216204e-27
# C9                            0.7861568 7.667706e-27
# C5_1                          0.7658212 9.215118e-25
# C5MDC                         0.7642113 1.318688e-24
# Xanthine                      0.7610896 2.620891e-24
# Ornithine                     0.7539923 1.202263e-23
# C14.2                         0.7514858 2.033724e-23
# O.Phosphocholine              0.7511050 2.201593e-23
# C16.2OH                       0.7502752 2.615661e-23
# Glutamate                     0.7457940 6.557766e-23
# X18.1SM                       0.7454756 6.995269e-23
# Hypoxanthine                  0.7401779 2.020220e-22
# IMP                           0.7362190 4.388909e-22
# Methionine                    0.7314097 1.105747e-21
# C6                            0.7209567 7.705434e-21
# Malonate                      0.7136497 2.842971e-20
# sn.Glycero.3.phosphocholine   0.7110180 4.504713e-20
# C6_1                          0.7031816 1.721545e-19
# Guanidoacetate                0.6986264 3.678986e-19
# C10.2                         0.6922204 1.045239e-18
# X18.0SM                       0.6839059 3.895305e-18
# Asymmetric.Dimethylarginine   0.6815826 5.582290e-18
# Mannose                       0.6735406 1.891567e-17
# C10                           0.6640550 7.603113e-17
# Cytidine                      0.6597189 1.412289e-16
# Acetone                       0.6555188 2.548203e-16
# Alanine                       0.6482394 6.933914e-16
# C4_1                          0.6381412 2.660207e-15
# Glutamine                     0.6328078 5.305225e-15
# C18_1OH                       0.6314900 6.278935e-15
# Total.Dimethylarginine        0.6308772 6.788854e-15
# Inosine                       0.6257792 1.291301e-14
# Carnitine                     0.6170840 3.764063e-14
# Aspartate                     0.6079927 1.112667e-13
# C12                           0.6060816 1.391286e-13
# Threonine.1                   0.5923677 6.625457e-13
# Threonine                     0.5923677 6.625457e-13
# Histidine                     0.5906638 8.002118e-13
# Nicotinurate                  0.5837881 1.695299e-12
# LYSOC18.2                     0.5780857 3.118256e-12
# Guanosine                     0.5745608 4.518283e-12
# Methylhistidine               0.5730961 5.264250e-12
# Proline                       0.5636543 1.384778e-11
# X1.Methylhistidine            0.5558348 3.015427e-11
# X16.1SM                       0.5479702 6.464407e-11
# C14.1OH                       0.5363630 1.922593e-10
# X16.0SM                       0.5344796 2.285649e-10
# Leucine                       0.5333486 2.534560e-10
# Phenylalanine                 0.5307521 3.208727e-10
# C16.1OH                       0.5230380 6.391286e-10
# Glycine                       0.5195551 8.674898e-10
# Isobutyrate                   0.5137996 1.426433e-09
# AMP                           0.5098196 2.001136e-09
# O.Acetylcarnitine             0.5073969 2.453876e-09
# X14.1SMOH                     0.4992198 4.827921e-09
# LYSOC18.1                     0.4899560 1.017474e-08
# C14                           0.4896168 1.045194e-08
# N_N_Dimethylglycine           0.4778156 2.615325e-08
# Tyrosine                      0.4761693 2.964207e-08
# C3                            0.4501097 1.975599e-07
# Acetamide                     0.4471784 2.421840e-07
# Valine                        0.4434023 3.139547e-07
# C16OH                         0.4358041 5.243261e-07
# X22.1SMOH                     0.4319963 6.748432e-07
# X24.1SMOH                     0.4276016 8.995991e-07
# LYSOC18.0                     0.4210225 1.373068e-06
# Isoleucine                    0.4199297 1.471708e-06
# Glycerol                      0.4140071 2.134448e-06
# PC40.6AA                      0.4107894 2.604512e-06
# C18                           0.3962297 6.249223e-06
# C5DC                          0.3920231 7.986328e-06
# C5OH                          0.3869783 1.067064e-05
# Tryptophan                    0.3824437 1.378961e-05
# Serine                        0.3809394 1.500139e-05
# LYSOC20.4                     0.3767099 1.896793e-05
# LYSOC20.3                     0.3712803 2.551291e-05
# C16.1                         0.3405302 1.240829e-04
# C18_1                         0.3343078 1.676098e-04
# PC36.6AA                      0.3335221 1.740178e-04
# Sarcosine                     0.3043355 6.541556e-04
# Spermidine                    0.3035128 6.777340e-04
# C5_1DC                        0.2933614 1.040318e-03
# PC32.2AA                      0.2926928 1.069521e-03
# Trans.Hydroxyproline          0.2863347 1.387046e-03
# C16                           0.2838464 1.533114e-03
# X16.1SMOH                     0.2681041 2.829463e-03
# C4                            0.2604722 3.760502e-03
# C8                            0.2599960 3.826808e-03
# Glucose                       0.2444588 6.654857e-03
# Uridine                       0.2388988 8.048070e-03
# C12DC                         0.2331607 9.750409e-03
# PC40.2AA                      0.2143053 1.777270e-02
# X22.2SMOH                     0.1983925 2.848208e-02
# Lactate                       0.1853820 4.092517e-02
# Acetyl.Ornithine              0.1818270 4.502610e-02
# LYSOC28.0                     0.1788145 4.876382e-02
# Spermine                     -0.2054512 2.319569e-02
# Citrate                      -0.2169883 1.636296e-02
# PC38.0AA                     -0.2427836 7.050168e-03
# PC36.0AE                     -0.2659938 3.063506e-03
# Formate                      -0.2937474 1.023793e-03
# LYSOC24.0                    -0.3151308 4.071214e-04
# Betaine                      -0.4013626 4.611703e-06
# Methionine.Sulfoxide         -0.4459146 2.642533e-07
# Pyruvate                     -0.5085158 2.233737e-09
# Dimethyl.Sulfone             -0.5288408 3.812247e-10
# Beta.Alanine                 -0.5331964 2.569989e-10
# Adenosine                    -0.5683296 8.610933e-12
# C3OH                         -0.5768344 3.558838e-12
# C10.1                        -0.5849054 1.502408e-12
# Methanol                     -0.6074945 1.179579e-13
dim.desc$Dim.2
# Link between the variable and the continuous variables (R-square)
# =================================================================================
#   correlation      p.value
# Valine                        0.7915672 1.962516e-27
# Isoleucine                    0.7800171 3.434501e-26
# Trans.Hydroxyproline          0.7740586 1.406530e-25
# Proline                       0.7116982 4.001475e-20
# Asparagine                    0.7059523 1.077059e-19
# Leucine                       0.7019210 2.127218e-19
# Tryptophan                    0.6952569 6.393526e-19
# Phenylalanine                 0.6838528 3.927569e-18
# C5                            0.6402474 2.017962e-15
# C3                            0.6177645 3.465861e-14
# Isobutyrate                   0.5853331 1.434329e-12
# Propylene.glycol              0.5448954 8.663390e-11
# Histidine                     0.5351600 2.147464e-10
# PC36.0AA                      0.5134215 1.473332e-09
# Asymmetric.Dimethylarginine   0.4954127 6.576312e-09
# Tyrosine                      0.4904766 9.763001e-09
# Total.Dimethylarginine        0.4735171 3.621756e-08
# Methionine                    0.4311821 7.119777e-07
# Lactate                       0.4051514 3.673146e-06
# LYSOC20.4                     0.3876668 1.025972e-05
# X2.Hydroxybutyrate            0.3824661 1.377223e-05
# Acetyl.Ornithine              0.3797883 1.599562e-05
# Spermidine                    0.3695658 2.798575e-05
# PC36.0AE                      0.3656296 3.453980e-05
# Glucose                       0.3639096 3.783379e-05
# Putrescine                    0.3637905 3.807252e-05
# Aspartate                     0.3325310 1.824254e-04
# Methionine.Sulfoxide          0.3279225 2.267064e-04
# Lysine                        0.3234961 2.784311e-04
# Kynurenine                    0.3164155 3.843204e-04
# Glutamine                     0.3157942 3.951959e-04
# Threonine.1                   0.3059306 6.105730e-04
# Threonine                     0.3059306 6.105730e-04
# Alpha.Aminoadipic.Acid        0.2901680 1.186674e-03
# C4                            0.2858786 1.412830e-03
# X16.1SMOH                     0.2637894 3.326454e-03
# Creatine                      0.2568542 4.291247e-03
# Sarcosine                     0.2528690 4.952659e-03
# O.Phosphocholine              0.2459603 6.317368e-03
# X16.0SM                       0.2418816 7.271539e-03
# C12DC                         0.2417706 7.299216e-03
# Ornithine                     0.2381442 8.255797e-03
# Citrulline                    0.2369361 8.598211e-03
# Spermine                      0.2348047 9.232968e-03
# Dimethyl.Sulfone              0.2308214 1.053065e-02
# IMP                           0.2299153 1.084731e-02
# Mannose                       0.2286518 1.130280e-02
# Alanine                       0.2064721 2.250555e-02
# PC38.0AA                      0.2030030 2.492501e-02
# Creatine.Phosphate            0.2020851 2.560121e-02
# Citrate                       0.2003500 2.692237e-02
# X16.1SM                       0.1978107 2.896026e-02
# X22.2SMOH                     0.1965930 2.998317e-02
# Glycine                       0.1962089 3.031207e-02
# X3.Hydroxybutyrate           -0.1975008 2.921774e-02
# PC40.2AA                     -0.2001057 2.711292e-02
# C10.2                        -0.2055390 2.313563e-02
# PC40.6AE                     -0.2059308 2.286922e-02
# PC38.6AA                     -0.2082253 2.136145e-02
# Acetone                      -0.2160574 1.684067e-02
# LYSOC26.1                    -0.2261111 1.226974e-02
# AMP                          -0.2318322 1.018704e-02
# Acetamide                    -0.2479099 5.901924e-03
# C10                          -0.2508514 5.321031e-03
# PC40.1AA                     -0.2521602 5.079390e-03
# LYSOC16.1                    -0.2531589 4.901630e-03
# C5MDC                        -0.2562058 4.393166e-03
# C9                           -0.2576311 4.171932e-03
# LYSOC18.1                    -0.2603241 3.781009e-03
# LYSOC24.0                    -0.2803010 1.765458e-03
# X18.0SM                      -0.2819505 1.653649e-03
# sn.Glycero.3.phosphocholine  -0.2873266 1.332438e-03
# 
# ATP                          -0.2922651 1.088593e-03
# Choline                      -0.2968864 8.980527e-04
# Carnitine                    -0.3083860 5.486744e-04
# C16.2                        -0.3109695 4.898208e-04
# LYSOC28.0                    -0.3151632 4.065305e-04
# O.Acetylcarnitine            -0.3203370 3.218055e-04
# C2                           -0.3204972 3.194633e-04
# C12                          -0.3252103 2.572254e-04
# Guanosine                    -0.3292557 2.129673e-04
# Ethanolamine                 -0.3348822 1.630649e-04
# LYSOC14.0                    -0.3520962 6.975344e-05
# C8                           -0.3545008 6.170662e-05
# C16OH                        -0.3554509 5.877324e-05
# LYSOC26.0                    -0.3585788 5.001115e-05
# C14.2                        -0.3593238 4.811257e-05
# PC32.2AA                     -0.3761429 1.956914e-05
# LYSOC16.0                    -0.3862866 1.109901e-05
# N_N_Dimethylglycine          -0.4072768 3.229010e-06
# X24.1SMOH                    -0.4150910 1.995108e-06
# LYSOC17.0                    -0.4352713 5.432716e-07
# ADP                          -0.4396673 4.046052e-07
# C12.1                        -0.4466908 2.504826e-07
# C14.2OH                      -0.4849854 1.504246e-08
# C18_2                        -0.4900885 1.006842e-08
# C16.2OH                      -0.5065467 2.634948e-09
# C14                          -0.5261314 4.858329e-10
# C18_1OH                      -0.5338693 2.416884e-10
# C14.1                        -0.5432801 1.009199e-10
# C18                          -0.5642091 1.309374e-11
# C14.1OH                      -0.5834466 1.758898e-12
# C16.1OH                      -0.6121146 6.836299e-14
# C16                          -0.6492059 6.080448e-16
# C16.1                        -0.6663439 5.460294e-17
# C18_1                        -0.6697109 3.337437e-17
dim.desc$Dim.3
# Link between the variable and the continuous variables (R-square)
# =================================================================================
#   correlation      p.value
# PC38.0AA                      0.8274134 7.459958e-32
# LYSOC28.1                     0.7694269 4.086309e-25
# PC36.0AE                      0.7516896 1.949068e-23
# X22.2SMOH                     0.7451721 7.438710e-23
# PC40.6AE                      0.7257748 3.184111e-21
# X22.1SMOH                     0.7064594 9.878687e-20
# PC40.1AA                      0.6826724 4.717234e-18
# Spermine                      0.6703578 3.033995e-17
# PC40.2AA                      0.6701750 3.116902e-17
# Citrate                       0.6674621 4.640054e-17
# PC38.6AA                      0.6133261 5.916393e-14
# Beta.Hydroxybutyrate          0.6044727 1.677323e-13
# C4                            0.5922983 6.676692e-13
# X3.Hydroxybutyrate            0.5872558 1.163508e-12
# C14.1                         0.5666820 1.018893e-11
# PC36.6AA                      0.5606769 1.866835e-11
# C3_1                          0.5553452 3.163870e-11
# PC36.0AA                      0.5339681 2.395162e-10
# C4OH                          0.5337557 2.442084e-10
# Creatine                      0.5260648 4.887239e-10
# C12.1                         0.5142723 1.369821e-09
# C8                            0.5043029 3.176650e-09
# LYSOC26.1                     0.4983897 5.166153e-09
# LYSOC24.0                     0.4975326 5.539198e-09
# LYSOC17.0                     0.4933423 7.767666e-09
# LYSOC16.1                     0.4875190 1.233414e-08
# C5_1DC                        0.4687532 5.168509e-08
# Putrescine                    0.4679960 5.466383e-08
# Putrescine                    0.4679960 5.466383e-08
# C3OH                          0.4626517 8.086782e-08
# Acetate                       0.4587795 1.069556e-07
# Creatinine                    0.4498902 2.006089e-07
# X16.0SM                       0.4341788 5.841823e-07
# Dimethyl.Sulfone              0.4222791 1.267407e-06
# LYSOC14.0                     0.4203012 1.437445e-06
# C5                            0.4054979 3.596996e-06
# Lactate                       0.4041627 3.898918e-06
# X14.1SMOH                     0.4025944 4.284158e-06
# LYSOC28.0                     0.3991463 5.261530e-06
# Kynurenine                    0.3878250 1.016745e-05
# X16.1SM                       0.3854004 1.167152e-05
# X24.1SMOH                     0.3848548 1.203770e-05
# Methionine.Sulfoxide          0.3741268 2.185509e-05
# Pyruvate                      0.3706030 2.646414e-05
# C2                            0.3692099 2.852658e-05
# LYSOC18.0                     0.3624899 4.077219e-05
# Methanol                      0.3552970 5.923937e-05
# LYSOC18.1                     0.3523441 6.888068e-05
# X16.1SMOH                     0.3392572 1.320238e-04
# Tryptophan                    0.3309353 1.967575e-04
# C16.1OH                       0.3308088 1.979375e-04
# LYSOC20.4                     0.3276327 2.297988e-04
# C16                           0.3271163 2.354078e-04
# C18_1                         0.3252989 2.561707e-04
# PC40.6AA                      0.3226310 2.897378e-04
# Asparagine                    0.3121869 4.641547e-04
# C14.1OH                       0.3120757 4.664458e-04
# LYSOC26.0                     0.3089626 5.350019e-04
# C5DC                          0.3062391 6.024585e-04
# C16.1                         0.2975864 8.720155e-04
# Uridine                       0.2881045 1.290991e-03
# Acetyl.Ornithine              0.2829016 1.592148e-03
# PC32.2AA                      0.2774902 1.971894e-03
# LYSOC20.3                     0.2701178 2.621302e-03
# C14                           0.2700634 2.626740e-03
# LYSOC18.2                     0.2677059 2.872357e-03
# C3                            0.2637215 3.334867e-03
# Alpha.Aminoadipic.Acid        0.2623654 3.506931e-03
# Formate                       0.2598738 3.843995e-03
# Spermidine                    0.2595399 3.891313e-03
# C10.1                         0.2562866 4.380340e-03
# LYSOC16.0                     0.2503740 5.411695e-03
# X2.Hydroxybutyrate            0.2494112 5.598748e-03
# Betaine                       0.2429997 6.998030e-03
# Adenosine                     0.2363546 8.767430e-03
# C18_1OH                       0.2316228 1.025739e-02
# X18.1SM                       0.2196777 1.504819e-02
# Beta.Alanine                  0.2180324 1.584116e-02
# C4_1                          0.2020277 2.564401e-02
# Aspartate                    -0.1844747 4.194084e-02
# X1.Methylhistidine           -0.1849585 4.139665e-02
# Ethanolamine                 -0.1900164 3.605274e-02
# ADP                          -0.1915997 3.450423e-02
# Taurine                      -0.2073904 2.189985e-02
# N_N_Dimethylglycine          -0.2086846 2.107008e-02
# Cytidine                     -0.2088165 2.098708e-02
# Malate                       -0.2183123 1.570375e-02
# ATP                          -0.2499296 5.497332e-03
# Xanthine                     -0.2800437 1.783506e-03
# Ornithine                    -0.2917716 1.110984e-03
# Arginine                     -0.2957087 9.434691e-04
# Lysine                       -0.3034369 6.799485e-04
# IMP                          -0.3035785 6.758217e-04
# Hypoxanthine                 -0.3085669 5.443501e-04
# sn.Glycero.3.phosphocholine  -0.3138872 4.303757e-04
# Guanidoacetate               -0.3387759 1.351476e-04
# Methylhistidine              -0.3478297 8.649190e-05
# Mannose                      -0.3514864 7.194474e-05
# Acetamide                    -0.3614800 4.299108e-05
dim.desc$Dim.4
# Link between the variable and the continuous variables (R-square)
# =================================================================================
#   correlation      p.value
# C16.1                    0.4825282 1.820811e-08
# C18_1                    0.4770714 2.767855e-08
# X3.Hydroxybutyrate       0.4630747 7.841872e-08
# C16                      0.4583498 1.103030e-07
# Beta.Hydroxybutyrate     0.4505943 1.909839e-07
# Serine                   0.4472578 2.408561e-07
# C14.1                    0.4461184 2.605700e-07
# C14                      0.4128459 2.293946e-06
# C18                      0.4101790 2.704097e-06
# Glycine                  0.3646811 3.632151e-05
# C10.1                    0.3561604 5.666825e-05
# Pyruvate                 0.3502239 7.668700e-05
# C14.1OH                  0.3442946 1.031245e-04
# Succinate                0.3412120 1.200148e-04
# C8                       0.3389978 1.336991e-04
# C2                       0.3226651 2.892843e-04
# Citrate                  0.3040608 6.619425e-04
# Sarcosine                0.2987369 8.307178e-04
# C16.1OH                  0.2911280 1.140814e-03
# Tyrosine                 0.2771050 2.001828e-03
# C12                      0.2654510 3.126452e-03
# C12.1                    0.2593353 3.920550e-03
# Alpha.Aminoadipic.Acid   0.2591554 3.946441e-03
# C4OH                     0.2525586 5.007807e-03
# C16OH                    0.2485211 5.776771e-03
# Glutamate                0.2398557 7.791332e-03
# Tryptophan               0.2365789 8.701814e-03
# Methionine.Sulfoxide     0.2217130 1.411527e-02
# Phenylalanine            0.2190469 1.534806e-02
# Threonine.1              0.2120326 1.904795e-02
# Threonine                0.2120326 1.904795e-02
# C18_2                    0.2022688 2.546465e-02
# Adenosine                0.2003561 2.691759e-02
# C4                       0.1934363 3.277861e-02
# Acetone                  0.1898390 3.622980e-02
# C18_1OH                  0.1818316 4.502055e-02
# LYSOC18.0               -0.1783438 4.937042e-02
# PC36.0AA                -0.1840433 4.243119e-02
# Inosine                 -0.1842858 4.215498e-02
# Aspartate               -0.1876577 3.846775e-02
# Guanosine               -0.2277696 1.163071e-02
# X16.0SM                 -0.2315583 1.027915e-02
# LYSOC18.2               -0.2402644 7.683907e-03
# C6                      -0.2447841 6.580397e-03
# LYSOC18.1               -0.2509578 5.301022e-03
# X22.2SMOH               -0.2699613 2.636973e-03
# Ethanol                 -0.2746066 2.206179e-03
# X14.1SMOH               -0.2803497 1.762062e-03
# X22.1SMOH               -0.2834434 1.558043e-03
# C10.2                   -0.2889608 1.246726e-03
# PC40.1AA                -0.2944004 9.963807e-04
# Isopropanol             -0.2951902 9.641233e-04
# C4_1                    -0.2970657 8.913177e-04
# Malonate                -0.3081477 5.544200e-04
# LYSOC24.0               -0.3096105 5.200136e-04
# C5_1                    -0.3157562 3.958703e-04
# Formate                 -0.3182123 3.544019e-04
# LYSOC16.1               -0.3191579 3.395359e-04
# X16.1SMOH               -0.3347312 1.642487e-04
# LYSOC28.1               -0.3690305 2.880279e-05
# C6_1                    -0.3871630 1.055889e-05
# AMP                     -0.4734682 3.635106e-08
# LYSOC17.0               -0.4954631 6.549649e-09
# LYSOC16.0               -0.5127360 1.562160e-09
# PC40.2AA                -0.5134528 1.469398e-09
# LYSOC26.1               -0.5191114 9.016866e-10
# LYSOC14.0               -0.5309857 3.141615e-10
# LYSOC28.0               -0.5391197 1.489680e-10
# LYSOC26.0               -0.5707014 6.747405e-12
dim.desc$Dim.5
# Link between the variable and the continuous variables (R-square)
# =================================================================================
#   correlation      p.value
# PC40.6AA                      0.6008115 2.556875e-13
# PC32.2AA                      0.5515899 4.562184e-11
# PC38.6AA                      0.5153721 1.246350e-09
# PC36.6AA                      0.5031875 3.484313e-09
# Choline                       0.4745191 3.358413e-08
# LYSOC18.0                     0.4725675 3.889485e-08
# LYSOC18.1                     0.4448049 2.852037e-07
# X18.0SM                       0.4256897 1.018161e-06
# Serine                        0.4230502 1.206438e-06
# LYSOC18.2                     0.4136230 2.186007e-06
# X24.1SMOH                     0.4003124 4.909550e-06
# PC40.6AE                      0.3934719 7.342160e-06
# Succinate                     0.3690666 2.874707e-05
# C12DC                         0.3426761 1.116951e-04
# X18.1SM                       0.3331592 1.770534e-04
# PC40.1AA                      0.2978276 8.632029e-04
# Glucose                       0.2929715 1.057257e-03
# Pyruvate                      0.2755820 2.124254e-03
# LYSOC16.1                     0.2730627 2.341715e-03
# Glutamate                     0.2537407 4.800670e-03
# Ethanolamine                  0.2518650 5.133014e-03
# Alanine                       0.2459041 6.329728e-03
# Sarcosine                     0.2366810 8.672080e-03
# C10.1                         0.2194451 1.515819e-02
# Phenylalanine                 0.2160931 1.682216e-02
# LYSOC17.0                     0.2117167 1.923128e-02
# LYSOC16.0                     0.2022032 2.551334e-02
# sn.Glycero.3.phosphocholine   0.1992486 2.779078e-02
# Betaine                       0.1979370 2.885589e-02
# LYSOC20.4                     0.1973176 2.937090e-02
# Malate                        0.1948798 3.147410e-02
# Threonine.1                   0.1932811 3.292150e-02
# Threonine                     0.1932811 3.292150e-02
# ADP                           0.1871661 3.898787e-02
# Cytidine                      0.1837052 4.281879e-02
# Malonate                     -0.1792298 4.823366e-02
# Methanol                     -0.1816053 4.529277e-02
# Citrate                      -0.1867475 3.943540e-02
# Acetoacetate                 -0.2063624 2.257880e-02
# C4OH                         -0.2068140 2.227836e-02
# AMP                          -0.2086368 2.110023e-02
# C16OH                        -0.2273288 1.179761e-02
# C14.1OH                      -0.2337662 9.556933e-03
# C16.2OH                      -0.2390616 8.003876e-03
# C18_1OH                      -0.2399920 7.755345e-03
# C4_1                         -0.2419122 7.263929e-03
# Beta.Hydroxybutyrate         -0.2448000 6.576799e-03
# X3.Hydroxybutyrate           -0.2554193 4.519678e-03
# C5                           -0.2585313 4.037407e-03
# Dimethyl.Sulfone             -0.2608377 3.710298e-03
# X16.1SMOH                    -0.2664982 3.006029e-03
# C4                           -0.2714852 2.487937e-03
# Creatinine                   -0.2723646 2.405439e-03
# C10.2                        -0.2824022 1.624175e-03
# Propylene.glycol             -0.2975662 8.727574e-04
# Creatine                     -0.2985693 8.366178e-04
# C5MDC                        -0.3079510 5.592028e-04
# C14.2                        -0.3149201 4.109778e-04
# C8                           -0.3259146 2.489541e-04
# C9                           -0.3421247 1.147631e-04
# C5_1                         -0.3607648 4.463030e-05
# C10                          -0.3809491 1.499327e-05
# C3_1                         -0.3825922 1.367508e-05
# C6_1                         -0.4089280 2.919600e-06
# C12.1                        -0.4098125 2.765608e-06
# C6                           -0.4478883 2.305690e-07
# C5DC                         -0.5339634 2.396184e-10
# C5_1DC                       -0.5555113 3.112737e-11



#### extract the results for individuals ####
ind <- get_pca_ind(DM_pca_FM)
ind
# Principal Component Analysis Results for individuals
#   Name       Description                       
# 1 "$coord"   "Coordinates for the individuals" 
# 2 "$cos2"    "Cos2 for the individuals"        
# 3 "$contrib" "contributions of the individuals"
ind$coord
# Dim.1        Dim.2        Dim.3       Dim.4        Dim.5
# 1     7.4608310 -4.944358962 -2.486684740  3.74312969  -1.66028187
# 2     9.4264535 -8.607239807  2.045574754  4.02077436   0.82737415
# 3     2.2253632 -4.975999389 -6.479057238  3.53772454  -4.32908546
# 4     1.3674526 -2.273629794 -4.582672328  3.33549314   5.08219269
# 5     6.4348287 -2.676843041 -1.129184021  1.18938262   1.16769111
# 6     6.6712362 -4.716722736 -0.119548213 -9.02401309  -1.32499572
# 7     3.2671457 -1.649752384 -6.988579802  3.51701181  -0.73009939
# 8     5.3526595 -6.524993040 -0.866754280  2.91989874   1.68112617
# 9     8.3916658 -2.772759571 -3.657622103  4.49195275   0.61831286
# 10   13.7358639 -4.318366757  3.278649977 -0.99161874  -1.82604530
# 11    2.5383022 -1.341399606 -2.608300019  0.54467715   6.30169588
# 12    8.4777293 -6.762354966 -2.669417891 -0.99785862  -1.49091578
# 13    1.6751074 -1.079953146 -6.054198431  1.51031242   2.11720494
# 14    8.6209245 -4.215883313 -0.234722479  3.92025126   4.85950164
# 15    7.1245250 -4.166957607 -0.281774176 -0.52070583   2.71152913
# 16    8.7709716 -1.780853866 -0.145232356  1.77945849   4.62610961
# 17    2.2995063 -5.071702724 -1.061898319  1.14908096   5.32466400
# 18    8.4860377 -0.837068628 -3.136278343  0.43638467  -2.66489846
# 19    1.8923362 -2.578501727 -4.380851864  2.38377911   0.36173848
# 20    3.7322788 -4.143344484 -1.727394791 -3.11376445   0.65683976
# 21    1.5832766 -0.731000050 -6.381965970  1.56124743  -4.77715993
# 22    5.4136361 -4.039445785 -1.175455330 -3.36541946  -2.30593245
# 23    3.9776183 -3.509717376 -0.441037402 -1.94546604   2.50857362
# 24    2.8308553 -3.103467138 -1.598256969  0.46684968   1.79758867
# 25    4.4253146 -4.193702622 -2.179076042 -3.29892826  -1.30002290
# 26    0.7588475 -2.026739837 -4.274106541  1.44436186   1.38066257
# 27    8.3064167  5.563445679 -1.177323098  0.19967522   1.06312331
# 28    3.7690399  0.224853333 -5.967256173 -0.30329398  -3.71383065
# 29    1.5461427 -2.034102877 -3.352640294 -5.15739315  -2.27231866
# 30    4.7516149  7.235598661 -4.085806470  5.09642476   1.63153536
# 31    4.0924597 -0.634505852 -3.874651559  1.37012374   3.21775861
# 32    5.5218493  0.322311089 -2.783828827 -0.01369706  -1.94466312
# 33    6.7699894 -2.836336056  0.006618724  3.43060700   4.87829130
# 34    3.9481036 -3.076516762 -2.293870200 -1.62442248  -2.51776532
# 35    6.7906400 -3.847671626  0.542762142 -3.24730263  -2.28794189
# 36    4.8070985  6.207911698 -3.129394046  0.68039876  -2.62977457
# 37    3.5861401 -3.422993978 -3.825369137 -1.92728308  -3.90253620
# 38    3.9019765  5.735321915 -5.423835379  2.01636266  -0.24987705
# 39    0.7490184  1.874012048 -3.130161308 -1.93385860   1.81765972
# 40    3.1244528 -3.224215021 -1.091229432 -2.32047619  -4.43425379
# 41    9.0835089 -0.034213446  6.196983202 -3.99338061  -0.96251505
# 42    5.6921717  9.030571168 -2.317665466  2.25350835   1.39788318
# 43    3.7717505  8.744922282 -1.454942739  0.38400721   3.66569841
# 44    7.3410670  6.599285225 -1.743892614  2.07795529  -3.40004775
# 45    1.7933867 -0.071233643 -4.370845872  0.55778839  -3.08907906
# 46    4.3337586 10.584362362 -4.451912921  2.39157321   1.71989330
# 47    0.5072455 -1.343485787 -2.996769502 -1.67094582  -0.30999080
# 48    6.0683965 -2.048105135  2.125913498 -5.23673203  -2.01997994
# 49    7.7149715  0.561779989  3.041201131 -7.10754703  -2.91388089
# 50    5.0144218  3.512794461  0.051570498 -0.93021310   1.93924506
# 51    7.5894674 14.169788086 -1.531117129  2.35983926   1.00370721
# 52   12.4778685  8.392660706  9.852934363 -3.21751350   4.81569018
# 53    6.5095837  2.131519715  2.012030221 -3.75081755  -4.37120317
# 54    5.5079600 10.701018263 -2.081494266  0.22169609   0.18421136
# 55    3.3777560  4.440263500  1.257765839 -6.45287488   2.60404201
# 56    2.9459987  3.225939874 -2.572957915 -3.13146900  -2.98986936
# 57    6.1210154 -3.790365355  1.654837971 -0.95547107  -4.77685532
# 58    7.6417441  9.177706512 -2.946720995  0.26064152  -5.22557203
# 59    8.2360020 -1.186558069  4.112987653 -7.67667440   1.12204744
# 60    4.5241699 -1.886618229  1.402973425 -3.79770841   4.43009864
# 61    6.0158737  2.340607380 -2.661695070 -0.55522465  -1.94132635
# 62    1.6120558 -0.003312731 -1.192901620 -1.96152888   2.90393220
# 63    0.7952169 -2.572504833  5.953246367  4.24578538   7.01264251
# 64   -7.2724799 -3.031948713 -0.100047860 -1.14821969   0.27852825
# 65   -5.0088982 -4.052917518  2.304472817 -0.32749981   0.05138062
# 66   -5.7031344 -1.895342456 -1.028222386  1.69682558   1.79832812
# 67   -1.2621746  3.207935236  2.366719122  4.18371738   4.03320362
# 68   -3.3739502  0.764822850 -0.686001994  4.27111660   2.12450089
# 69   -5.4736798 -1.150103187  1.072192109  1.50931967   3.00973241
# 70   -0.9297437 -2.361889441  4.692026653  4.31584481   4.53116000
# 71   -2.7832224 -2.812205178  0.653895479  4.04214117   1.99913381
# 72   -1.4810289 -5.732226025  4.439019346  4.87459654  -1.55618797
# 73   -7.6911074  0.075899946 -5.819968717  3.21183017  -0.69789123
# 74   -8.0394343 -2.841233256 -0.914825353 -2.75227721   1.97229497
# 75   -6.6443398 -2.951092576  4.178471505 -3.41166243   2.51482789
# 76   -9.5523859 -0.856952127 -4.201511203  0.07596011  -1.84369428
# 77   -9.5491013 -2.316932563 -5.645654238  1.20049578  -1.83916518
# 78   -4.7218527 -1.382467248  1.669644640  0.74069681   3.33974097
# 79   -9.4686783 -3.133845343 -4.494197206 -1.56077707  -0.36336328
# 80   -7.7432922 -3.306940511  0.040433427 -1.65559311   0.62198800
# 81  -11.1739732 -0.866590449 -8.217510229  0.15292259  -3.06893703
# 82   -5.6186754 -4.937771632  7.047671158 -4.03928454   3.16837799
# 83   -7.9344114  0.584152278 -5.183598546  2.32508870   0.79834600
# 84   -3.8864516 -1.315372780  0.748013687  1.24027778   3.40214639
# 85   -5.3852301  1.581429574  0.482767576 -0.45377461   0.55171723
# 86   -6.4283952 -1.824079579 -0.564958577 -0.37212588   1.43854821
# 87   -8.9222932 -1.644687813 -3.285479204 -2.02272948  -1.16178592
# 88   -5.1665305 -3.828328297  0.865049772 -1.62624434  -1.49209040
# 89   -7.7170904 -1.215053118 -1.058253130 -2.67180182  -0.45312198
# 90   -8.3856736 -0.755758618 -2.067451111  1.63231042   1.47896702
# 91   -4.3887200 -4.653834178  2.226410840 -0.61684500   2.31260372
# 92   -3.1924640  2.555489009  3.195659948  0.90935693   1.60046222
# 93   -5.5222393  1.360989358  2.984017362 -1.21505280   2.27299993
# 94   -6.5229780  0.603366448 -0.832496248 -0.52495871  -0.85862528
# 95   -4.5640831 -0.020096778  8.311632392 -4.21376207   3.51402701
# 96   -6.3244712 -0.868322771  2.816489984 -3.79384528   0.19323642
# 97   -8.9546687  0.706787944 -4.416663813  1.25874896  -3.68569358
# 98   -6.0213846  1.281674760  0.368133110 -0.24244943  -1.00771064
# 99   -6.3678972  1.998819681  1.580964174 -0.58969240  -1.44667145
# 100  -5.2170692  1.470195130  3.708642499 -0.98010574  -0.03509588
# 101  -4.2771320 -1.661438037  4.609532429  0.38504901  -1.49043722
# 102  -5.9635204  0.521298752  0.489007149  0.61915387   2.08930225
# 103  -5.6980917 -2.347795561 -0.274142217  3.65601695  -7.14834438
# 104  -4.0160962 -3.238350820  3.413374589  0.06151199   2.20446789
# 105  -6.5922007 -0.539183744 -2.686977580 -0.11138068  -1.69792368
# 106  -6.5045980 -1.419993359  0.495387252  0.28717504  -2.83288361
# 107  -6.0081360 -2.107145870 -0.287431406  0.47068982  -0.53162300
# 108  -4.2505491  7.043087491  3.530431714  0.61605278  -1.53987703
# 109  -5.1132376  4.472429572  5.836289341 -0.32757344  -0.31987843
# 110  -3.1276275  6.311098080  9.058326433  0.74909093  -0.75127385
# 111   8.0870508 -9.074813996 24.261964192 12.72551569 -10.23029999
# 112  -2.6683332  5.585439791  8.485908841 -1.87066563  -2.05425522
# 113  -5.9701580  1.160482122  0.328666657 -0.61295500  -1.64936892
# 114  -3.6093090  5.656094973  5.612367307  2.34304619  -4.84142260
# 115  -8.4047833  0.871902752 -0.065674613 -0.95723287  -0.72868783
# 116  -6.2029947  3.597609515  1.646275260 -0.31952987  -0.55252753
# 117  -5.7736416  4.672234068  0.277514836  0.85009600  -1.85065863
# 118  -4.6525003  5.170012672  6.314935872  0.50553916  -1.40583840
# 119  -6.9343844  1.830625868  0.945006363 -2.46591613  -0.60949354
# 120  -4.0852487  3.736243893  5.401101186 -2.85520325   1.31882766
# 121  -3.9835651  9.434316561  3.142171637  3.20222796  -1.78391434
# 122  -3.1388408  8.169099032  3.812778890  0.35218800  -0.15765411

ind$cos2
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# 1   0.351844931 1.545243e-01 3.908574e-02 8.856184e-02 0.0174237063
# 2   0.366564142 3.056195e-01 1.726172e-02 6.669184e-02 0.0028239514
# 3   0.034231663 1.711539e-01 2.901682e-01 8.651157e-02 0.1295443569
# 4   0.017490144 4.835132e-02 1.964294e-01 1.040612e-01 0.2415856123
# 5   0.379062712 6.559684e-02 1.167257e-02 1.295031e-02 0.0124822545
# 6   0.095019641 4.749867e-02 3.051314e-05 1.738602e-01 0.0037482599
# 7   0.102645764 2.617228e-02 4.696582e-01 1.189465e-01 0.0051258750
# 8   0.235635489 3.501560e-01 6.178648e-03 7.011921e-02 0.0232435296
# 9   0.303868372 3.317520e-02 5.772804e-02 8.706819e-02 0.0016497028
# 10  0.541506306 5.352179e-02 3.085188e-02 2.822156e-03 0.0095700599
# 11  0.058703842 1.639443e-02 6.198619e-02 2.703076e-03 0.3618218201
# 12  0.357289323 2.273301e-01 3.542371e-02 4.949929e-03 0.0110501245
# 13  0.035683862 1.483189e-02 4.661223e-01 2.900816e-02 0.0570049202
# 14  0.280377315 6.705210e-02 2.078474e-04 5.797797e-02 0.0890878861
# 15  0.435105895 1.488406e-01 6.805899e-04 2.324171e-03 0.0630248299
# 16  0.447386220 1.844352e-02 1.226631e-04 1.841463e-02 0.1244569141
# 17  0.032020143 1.557621e-01 6.828416e-03 7.995679e-03 0.1716874274
# 18  0.408753950 3.977170e-03 5.583175e-02 1.080914e-03 0.0403100540
# 19  0.035141142 6.524603e-02 1.883373e-01 5.576366e-02 0.0012841291
# 20  0.139950830 1.724763e-01 2.997854e-02 9.740894e-02 0.0043345716
# 21  0.022121059 4.715493e-03 3.594192e-01 2.150977e-02 0.2013872129
# 22  0.281941127 1.569726e-01 1.329207e-02 1.089579e-01 0.0511532792
# 23  0.192080827 1.495485e-01 2.361504e-03 4.594996e-02 0.0763996727
# 24  0.061058392 7.338450e-02 1.946271e-02 1.660597e-03 0.0246201489
# 25  0.235430165 2.114312e-01 5.708455e-02 1.308337e-01 0.0203177593
# 26  0.002648730 1.889403e-02 8.402710e-02 9.595789e-03 0.0087680652
# 27  0.423185965 1.898417e-01 8.501492e-03 2.445413e-04 0.0069322005
# 28  0.100647310 3.582114e-04 2.522842e-01 6.517309e-04 0.0977203222
# 29  0.027422741 4.746326e-02 1.289394e-01 3.051211e-01 0.0592311501
# 30  0.095303919 2.209923e-01 7.046669e-02 1.096376e-01 0.0112362471
# 31  0.181047893 4.352070e-03 1.622893e-01 2.029291e-02 0.1119261528
# 32  0.258376946 8.803090e-04 6.567041e-02 1.589789e-06 0.0320459697
# 33  0.217183026 3.812109e-02 2.075862e-07 5.576887e-02 0.1127678652
# 34  0.203426881 1.235236e-01 6.867030e-02 3.443731e-02 0.0827297597
# 35  0.303141474 9.732400e-02 1.936614e-03 6.932174e-02 0.0344123171
# 36  0.126818968 2.114994e-01 5.374508e-02 2.540652e-03 0.0379537956
# 37  0.109282510 9.956540e-02 1.243492e-01 3.156365e-02 0.1294166180
# 38  0.103570105 2.237591e-01 2.001143e-01 2.765683e-02 0.0004247348
# 39  0.008049693 5.038939e-02 1.405814e-01 5.365915e-02 0.0474044968
# 40  0.082494139 8.784623e-02 1.006253e-02 4.550188e-02 0.1661560834
# 41  0.263758627 3.741907e-06 1.227609e-01 5.097777e-02 0.0029615185
# 42  0.182329205 4.589133e-01 3.022747e-02 2.857713e-02 0.0109961843
# 43  0.090159843 4.846622e-01 1.341588e-02 9.345574e-04 0.0851609896
# 44  0.303693013 2.454202e-01 1.713783e-02 2.433262e-02 0.0651458052
# 45  0.043456245 6.856060e-05 2.581281e-01 4.203812e-03 0.1289324833
# 46  0.082245706 4.905838e-01 8.679149e-02 2.504674e-02 0.0129534906
# 47  0.004445291 3.118386e-02 1.551567e-01 4.823791e-02 0.0016602036
# 48  0.219026353 2.494899e-02 2.688064e-02 1.631057e-01 0.0242684806
# 49  0.305883090 1.621882e-03 4.753102e-02 2.596129e-01 0.0436345407
# 50  0.246879882 1.211573e-01 2.611239e-05 8.495890e-03 0.0369240521
# 51  0.151840788 5.292886e-01 6.179917e-03 1.468016e-02 0.0026557056
# 52  0.319710369 1.446356e-01 1.993458e-01 2.125772e-02 0.0476203946
# 53  0.301005882 3.227359e-02 2.875660e-02 9.993565e-02 0.1357283377
# 54  0.149934978 5.659416e-01 2.141272e-02 2.429056e-04 0.0001677082
# 55  0.078244837 1.352124e-01 1.084923e-02 2.855654e-01 0.0465045152
# 56  0.095081296 1.140099e-01 7.252627e-02 1.074302e-01 0.0979342107
# 57  0.245387588 9.409527e-02 1.793563e-02 5.979168e-03 0.1494479000
# 58  0.239682558 3.457162e-01 3.563933e-02 2.788295e-04 0.1120776778
# 59  0.284786773 5.911054e-03 7.102345e-02 2.474191e-01 0.0052857834
# 60  0.153430845 2.668105e-02 1.475481e-02 1.081130e-01 0.1471165947
# 61  0.175632682 2.658674e-02 3.438148e-02 1.496048e-03 0.0182896337
# 62  0.037727652 1.593206e-07 2.065898e-02 5.585847e-02 0.1224256993
# 63  0.003300585 3.454078e-02 1.849811e-01 9.408834e-02 0.2566747473
# 64  0.474277329 8.243488e-02 8.976002e-05 1.182272e-02 0.0006956740
# 65  0.198358037 1.298676e-01 4.198639e-02 8.479837e-04 0.0000208720
# 66  0.361305392 3.990457e-02 1.174414e-02 3.198318e-02 0.0359240348
# 67  0.011145534 7.199680e-02 3.918821e-02 1.224579e-01 0.1138052495
# 68  0.139910798 7.189449e-03 5.783952e-03 2.242109e-01 0.0554737769
# 69  0.367941692 1.624403e-02 1.411775e-02 2.797581e-02 0.1112438477
# 70  0.006375064 4.114122e-02 1.623600e-01 1.373693e-01 0.1514177638
# 71  0.090191303 9.207948e-02 4.978351e-03 1.902356e-01 0.0465320918
# 72  0.011190278 1.676334e-01 1.005282e-01 1.212247e-01 0.0123548634
# 73  0.441494714 4.299626e-05 2.528070e-01 7.699329e-02 0.0036351576
# 74  0.396818668 4.956269e-02 5.138277e-03 4.650776e-02 0.0238827782
# 75  0.255424614 5.038772e-02 1.010169e-01 6.734280e-02 0.0365911127
# 76  0.658449369 5.299218e-03 1.273825e-01 4.163608e-05 0.0245288100
# 77  0.457195550 2.691558e-02 1.598106e-01 7.226005e-03 0.0169597115
# 78  0.260329649 2.231559e-02 3.254969e-02 6.405893e-03 0.1302339844
# 79  0.517279964 5.666333e-02 1.165336e-01 1.405493e-02 0.0007617790
# 80  0.548771974 1.000906e-01 1.496311e-05 2.508695e-02 0.0035408264
# 81  0.530588257 3.191319e-03 2.869610e-01 9.937696e-05 0.0400238014
# 82  0.138614437 1.070539e-01 2.180880e-01 7.163899e-02 0.0440772572
# 83  0.457282381 2.478604e-03 1.951721e-01 3.926758e-02 0.0046295347
# 84  0.188014587 2.153688e-02 6.964727e-03 1.914798e-02 0.1440757945
# 85  0.195705895 1.687699e-02 1.572793e-03 1.389555e-03 0.0020541326
# 86  0.503308218 4.052439e-02 3.887426e-03 1.686587e-03 0.0252044794
# 87  0.585176549 1.988387e-02 7.934716e-02 3.007527e-02 0.0099217015
# 88  0.206986584 1.136482e-01 5.802650e-03 2.050765e-02 0.0172637238
# 89  0.441745936 1.095105e-02 8.307006e-03 5.295096e-02 0.0015229851
# 90  0.530185487 4.306437e-03 3.222719e-02 2.008896e-02 0.0164918321
# 91  0.184712942 2.077033e-01 4.753705e-02 3.648999e-03 0.0512889757
# 92  0.115684635 7.412619e-02 1.159164e-01 9.386257e-03 0.0290746515
# 93  0.174558586 1.060279e-02 5.096986e-02 8.450863e-03 0.0295739686
# 94  0.530813163 4.541634e-03 8.645984e-03 3.437955e-03 0.0091972331
# 95  0.114013314 2.210555e-06 3.781126e-01 9.718260e-02 0.0675862997
# 96  0.420171168 7.920274e-03 8.332863e-02 1.511949e-01 0.0003922435
# 97  0.527541562 3.286517e-03 1.283354e-01 1.042404e-02 0.0893708909
# 98  0.482422349 2.185699e-02 1.803202e-03 7.821265e-04 0.0135115874
# 99  0.445008102 4.384530e-02 2.742963e-02 3.816163e-03 0.0229676021
# 100 0.305662162 2.427384e-02 1.544609e-01 1.078784e-02 0.0000138325
# 101 0.153640009 2.318288e-02 1.784484e-01 1.245177e-03 0.0186563378
# 102 0.433732037 3.314282e-03 2.916396e-03 4.675341e-03 0.0532376195
# 103 0.171906107 2.918455e-02 3.979095e-04 7.076994e-02 0.2705474048
# 104 0.211459099 1.374884e-01 1.527517e-01 4.960640e-05 0.0637126576
# 105 0.479586194 3.208333e-03 7.967717e-02 1.369070e-04 0.0318157496
# 106 0.429336891 2.046114e-02 2.490273e-03 8.368559e-04 0.0814356851
# 107 0.514125547 6.323811e-02 1.176679e-03 3.155435e-03 0.0040252902
# 108 0.123828455 3.399825e-01 8.542520e-02 2.601155e-03 0.0162518369
# 109 0.195933959 1.499011e-01 2.552651e-01 8.041464e-04 0.0007668098
# 110 0.054156156 2.205097e-01 4.542697e-01 3.106611e-03 0.0031247432
# 111 0.060062531 7.563081e-02 5.405990e-01 1.487216e-01 0.0961169598
# 112 0.033439804 1.465205e-01 3.382052e-01 1.643524e-02 0.0198194867
# 113 0.414861827 1.567504e-02 1.257312e-03 4.373096e-03 0.0316641217
# 114 0.088671804 2.177563e-01 2.144024e-01 3.736794e-02 0.1595450760
# 115 0.570117582 6.135465e-03 3.481019e-05 7.395143e-03 0.0042854302
# 116 0.439161876 1.477236e-01 3.093333e-02 1.165319e-03 0.0034844132
# 117 0.280574172 1.837373e-01 6.482171e-04 6.082526e-03 0.0288270819
# 118 0.126696121 1.564493e-01 2.334148e-01 1.495892e-03 0.0115680805
# 119 0.413643625 2.882768e-02 7.682100e-03 5.230788e-02 0.0031955728
# 120 0.137984611 1.154155e-01 2.411894e-01 6.740121e-02 0.0143803593
# 121 0.069561474 3.901628e-01 4.327975e-02 4.494997e-02 0.0139499592
# 122 0.059433043 4.025666e-01 8.769455e-02 7.482358e-04 0.0001499340

ind$contrib
# Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
# 1   1.265238752 1.083836e+00 2.813247e-01 1.314462e+00 2.769047e-01
# 2   2.019736607 3.284517e+00 1.903694e-01 1.516693e+00 6.876551e-02
# 3   0.112564097 1.097752e+00 1.909809e+00 1.174157e+00 1.882604e+00
# 4   0.042503301 2.291834e-01 9.554413e-01 1.043755e+00 2.594592e+00
# 5   0.941178639 3.176797e-01 5.800906e-02 1.327155e-01 1.369691e-01
# 6   1.011604410 9.863349e-01 6.502084e-04 7.639725e+00 1.763582e-01
# 7   0.242624735 1.206650e-01 2.222001e+00 1.160449e+00 5.354645e-02
# 8   0.651234377 1.887573e+00 3.417892e-02 7.998598e-01 2.839013e-01
# 9   1.600642842 3.408538e-01 6.086450e-01 1.892992e+00 3.840461e-02
# 10  4.288545646 8.267662e-01 4.890537e-01 9.225029e-02 3.349576e-01
# 11  0.146448433 7.977376e-02 3.095148e-01 2.783278e-02 3.989162e+00
# 12  1.633643044 2.027401e+00 3.241899e-01 9.341494e-02 2.232919e-01
# 13  0.063779834 5.170750e-02 1.667553e+00 2.139991e-01 4.502903e-01
# 14  1.689296036 7.879903e-01 2.506546e-03 1.441804e+00 2.372194e+00
# 15  1.153745213 7.698070e-01 3.612175e-03 2.543684e-02 7.385762e-01
# 16  1.748612144 1.406048e-01 9.596065e-04 2.970667e-01 2.149803e+00
# 17  0.120189705 1.140384e+00 5.130176e-02 1.238738e-01 2.848073e+00
# 18  1.636846645 3.106460e-02 4.475026e-01 1.786559e-02 7.133917e-01
# 19  0.081394428 2.947668e-01 8.731393e-01 5.331020e-01 1.314487e-02
# 20  0.316625758 7.611071e-01 1.357531e-01 9.095987e-01 4.333967e-02
# 21  0.056978585 2.369073e-02 1.853000e+00 2.286766e-01 2.292484e+00
# 22  0.666156382 7.234146e-01 6.286062e-02 1.062568e+00 5.341459e-01
# 23  0.359620383 5.461199e-01 8.849470e-03 3.550795e-01 6.321504e-01
# 24  0.182151778 4.270099e-01 1.162143e-01 2.044713e-02 3.245992e-01
# 25  0.445129500 7.797205e-01 2.160286e-01 1.020996e+00 1.697730e-01
# 26  0.013089019 1.821125e-01 8.311073e-01 1.957178e-01 1.914881e-01
# 27  1.568286857 1.372244e+00 6.306055e-02 3.740474e-03 1.135361e-01
# 28  0.322893687 2.241519e-03 1.620003e+00 8.629903e-03 1.385514e+00
# 29  0.054337199 1.834381e-01 5.113760e-01 2.495392e+00 5.186868e-01
# 30  0.513192784 2.321093e+00 7.594899e-01 2.436742e+00 2.673990e-01
# 31  0.380685996 1.784904e-02 6.830173e-01 1.761156e-01 1.040097e+00
# 32  0.693054169 4.605685e-03 3.525749e-01 1.760083e-05 3.798879e-01
# 33  1.041775308 3.566638e-01 1.993035e-06 1.104130e+00 2.390574e+00
# 34  0.354303262 4.196259e-01 2.393889e-01 2.475576e-01 6.367915e-01
# 35  1.048140493 6.563564e-01 1.340249e-02 9.892905e-01 5.258438e-01
# 36  0.525247652 1.708578e+00 4.455402e-01 4.343155e-02 6.947104e-01
# 37  0.292315991 5.194646e-01 6.657529e-01 3.484732e-01 1.529891e+00
# 38  0.346072723 1.458342e+00 1.338380e+00 3.814307e-01 6.272194e-03
# 39  0.012752139 1.556999e-01 4.457587e-01 3.508551e-01 3.318883e-01
# 40  0.221894234 4.608841e-01 5.417495e-02 5.051642e-01 1.975185e+00
# 41  1.875449473 5.189641e-05 1.747137e+00 1.496097e+00 9.306402e-02
# 42  0.736468316 3.615548e+00 2.443813e-01 4.764273e-01 1.962947e-01
# 43  0.323358284 3.390436e+00 9.630708e-02 1.383430e-02 1.349834e+00
# 44  1.224944624 1.930801e+00 1.383585e-01 4.050892e-01 1.161280e+00
# 45  0.073104814 2.249645e-04 8.691553e-01 2.918887e-02 9.585721e-01
# 46  0.426901332 4.966759e+00 9.016951e-01 5.365938e-01 2.971459e-01
# 47  0.005848366 8.002208e-02 4.085762e-01 2.619407e-01 9.653045e-03
# 48  0.837039544 1.859723e-01 2.056163e-01 2.572758e+00 4.098839e-01
# 49  1.352903214 1.399188e-02 4.207815e-01 4.739339e+00 8.529240e-01
# 50  0.571531026 5.470779e-01 1.209955e-04 8.117891e-02 3.777741e-01
# 51  1.309244268 8.901648e+00 1.066555e-01 5.224481e-01 1.012001e-01
# 52  3.538986355 3.122792e+00 4.416697e+00 9.712232e-01 2.329613e+00
# 53  0.963173479 2.014292e-01 1.841770e-01 1.319867e+00 1.919414e+00
# 54  0.689572031 5.076845e+00 1.971137e-01 4.610992e-03 3.408785e-03
# 55  0.259331111 8.741001e-01 7.197240e-02 3.906473e+00 6.811813e-01
# 56  0.197270967 4.613773e-01 3.011839e-01 9.199719e-01 8.979893e-01
# 57  0.851618387 6.369507e-01 1.245883e-01 8.564724e-02 2.292192e+00
# 58  1.327342691 3.734324e+00 3.950431e-01 6.373317e-03 2.743054e+00
# 59  1.541810397 6.241970e-02 7.696286e-01 5.528719e+00 1.264705e-01
# 60  0.465238754 1.578017e-01 8.954994e-02 1.353074e+00 1.971485e+00
# 61  0.822612875 2.428851e-01 3.223168e-01 2.892117e-02 3.785854e-01
# 62  0.059068807 4.865371e-07 6.474044e-02 3.609672e-01 8.471098e-01
# 63  0.014373723 2.933973e-01 1.612405e+00 1.691198e+00 4.940036e+00
# 64  1.202162380 4.075561e-01 4.553884e-04 1.236882e-01 7.793010e-03
# 65  0.570272570 7.282479e-01 2.416070e-01 1.006237e-02 2.651951e-04
# 66  0.739307795 1.592645e-01 4.809949e-02 2.701175e-01 3.248663e-01
# 67  0.036210704 4.562416e-01 2.548354e-01 1.642113e+00 1.634056e+00
# 68  0.258747052 2.593375e-02 2.141002e-02 1.711438e+00 4.533990e-01
# 69  0.681015269 5.864315e-02 5.230119e-02 2.137178e-01 9.099604e-01
# 70  0.019648282 2.473220e-01 1.001584e+00 1.747471e+00 2.062460e+00
# 71  0.176073458 3.506208e-01 1.945284e-02 1.532856e+00 4.014676e-01
# 72  0.049856883 1.456768e+00 8.964797e-01 2.229234e+00 2.432713e-01
# 73  1.344546511 2.554034e-04 1.541018e+00 9.677952e-01 4.892628e-02
# 74  1.469092228 3.578965e-01 3.807525e-02 7.106613e-01 3.907603e-01
# 75  1.003463881 3.861085e-01 7.943306e-01 1.091969e+00 6.353065e-01
# 76  2.074062314 3.255793e-02 8.031145e-01 5.413143e-04 3.414637e-01
# 77  2.072636222 2.379964e-01 1.450090e+00 1.352071e-01 3.397881e-01
# 78  0.506784069 8.473316e-02 1.268278e-01 5.147060e-02 1.120450e+00
# 79  2.037871516 4.354104e-01 9.189051e-01 2.285389e-01 1.326322e-02
# 80  1.362854123 4.848378e-01 7.437851e-05 2.571494e-01 3.886250e-02
# 81  2.838006148 3.329442e-02 3.072182e+00 2.193924e-03 9.461123e-01
# 82  0.717572784 1.080950e+00 2.259736e+00 1.530690e+00 1.008418e+00
# 83  1.430960064 1.512850e-02 1.222444e+00 5.071744e-01 6.402492e-02
# 84  0.343324342 7.670813e-02 2.545573e-02 1.443166e-01 1.162714e+00
# 85  0.659183923 1.108775e-01 1.060334e-02 1.931785e-02 3.057735e-02
# 86  0.939297599 1.475133e-01 1.452110e-02 1.299146e-02 2.078814e-01
# 87  1.809468618 1.199253e-01 4.910931e-01 3.838433e-01 1.355873e-01
# 88  0.606730838 6.497736e-01 3.404463e-02 2.481132e-01 2.236439e-01
# 89  1.353646454 6.545370e-02 5.095016e-02 6.697100e-01 2.062514e-02
# 90  1.598357730 2.532269e-02 1.944630e-01 2.499677e-01 2.197272e-01
# 91  0.437798045 9.602084e-01 2.255158e-01 3.569689e-02 5.372410e-01
# 92  0.231659491 2.895288e-01 4.646089e-01 7.757952e-02 2.573106e-01
# 93  0.693152077 8.212080e-02 4.051064e-01 1.385060e-01 5.189979e-01
# 94  0.967141249 1.614009e-02 3.153051e-02 2.585405e-02 7.405836e-02
# 95  0.473483849 1.790592e-05 3.142961e+00 1.665783e+00 1.240443e+00
# 96  0.909172962 3.342767e-02 3.608966e-01 1.350323e+00 3.750980e-03
# 97  1.822624169 2.214736e-02 8.874729e-01 1.486471e-01 1.364599e+00
# 98  0.824120685 7.282816e-02 6.165611e-03 5.514684e-03 1.020090e-01
# 99  0.921701225 1.771295e-01 1.137131e-01 3.262341e-02 2.102357e-01
# 100 0.618658919 9.582827e-02 6.257435e-01 9.012062e-02 1.237311e-04
# 101 0.415818090 1.223804e-01 9.666742e-01 1.390946e-02 2.231486e-01
# 102 0.808357544 1.204806e-02 1.087920e-02 3.596462e-02 4.384997e-01
# 103 0.738000994 2.443792e-01 3.419151e-03 1.253992e+00 5.133076e+00
# 104 0.366611676 4.649342e-01 5.300713e-01 3.549750e-04 4.881736e-01
# 105 0.987777022 1.288894e-02 3.284691e-01 1.163853e-03 2.896030e-01
# 106 0.961698624 8.939564e-02 1.116493e-02 7.736984e-03 8.061655e-01
# 107 0.820498117 1.968489e-01 3.758676e-03 2.078490e-02 2.839058e-02
# 108 0.410665439 2.199226e+00 5.670509e-01 3.560526e-02 2.381984e-01
# 109 0.594278503 8.868103e-01 1.549673e+00 1.006690e-02 1.027866e-02
# 110 0.222345384 1.765849e+00 3.733037e+00 5.264382e-02 5.669742e-02
# 111 1.486546227 3.651062e+00 2.678048e+01 1.519249e+01 1.051341e+01
# 112 0.161837140 1.383115e+00 3.276145e+00 3.282998e-01 4.239118e-01
# 113 0.810157995 5.970636e-02 4.914481e-03 3.524808e-02 2.732765e-01
# 114 0.296105317 1.418329e+00 1.433041e+00 5.150389e-01 2.354576e+00
# 115 1.605650876 3.370387e-02 1.962282e-04 8.596339e-02 5.333960e-02
# 116 0.874582734 5.738148e-01 1.233023e-01 9.578582e-03 3.066723e-02
# 117 0.757700751 9.678162e-01 3.503796e-03 6.779759e-02 3.440483e-01
# 118 0.492006567 1.185023e+00 1.814280e+00 2.397662e-02 1.985352e-01
# 119 1.092984256 1.485740e-01 4.062897e-02 5.704728e-01 3.731685e-02
# 120 0.379345633 6.188909e-01 1.327184e+00 7.648079e-01 1.747201e-01
# 121 0.360696483 3.946068e+00 4.491860e-01 9.620171e-01 3.196795e-01
# 122 0.223942576 2.958639e+00 6.613778e-01 1.163664e-02 2.496763e-03



fviz_pca_ind(DM_pca_FM, col.ind = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE  # avoid text overlapping, slow if many points
)

IND_PCA <- fviz_pca_ind(DM_pca_FM, col.ind = "cos2",
                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                        repel = TRUE  # avoid text overlapping, slow if many points
)
ggsave("IND_PCA.PDF")
ggsave("IND_PCA.pdf")
# change point size according to cos2
fviz_pca_ind(DM_pca_FM, pointsize = "cos2", 
             pointshape = 21, fill = "#E7B800",
             repel = TRUE # Avoid text overlapping (slow if many points)
)
IND_PCA2<- fviz_pca_ind(DM_pca_FM, pointsize = "cos2", 
                        pointshape = 21, fill = "#E7B800",
                        repel = TRUE # Avoid text overlapping (slow if many points)
)
ggsave("IND_PCA2.pdf")
# to change boht pointsize and colour according to cos2
fviz_pca_ind(DM_pca_FM, col.ind = "cos2", pointsize = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             repel = TRUE # Avoid text overlapping (slow if many points)
)

IND_PCA3<- fviz_pca_ind(DM_pca_FM, col.ind = "cos2", pointsize = "cos2",
                        gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                        repel = TRUE # Avoid text overlapping (slow if many points)
)
ggsave("IND_PCA3.pdf")
# To visualize the contribution of individuals to the first two principal components
fviz_contrib(DM_pca_FM, choice = "ind", axes = 1:2)
indcontr<- fviz_contrib(DM_pca_FM, choice = "ind", axes = 1:2)
ggsave("indcontr.pdf")
#### Color by a custom continuous variable ####
# Year

fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Year")  

indyear1_2<- fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year,
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Year") 
ggsave("indyear1_2.pdf")

fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year, axes = c(2,3),
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Year")  
indyear2_3<- fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year, axes = c(2,3),
                          geom.ind = "point", # show points only (nbut not "text"),
                          pointsize = 2.5,
                          gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                          legend.title = "Year") 
ggsave("indyear2_3.pdf")

# W

fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$W,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Weight") 
indW <- fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$W,
                     geom.ind = "point", # show points only (nbut not "text"),
                     pointsize = 2.5,
                     gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                     legend.title = "Weight") 
ggsave("indW.pdf")
#### Color by groups Site ####
pca_PC1_PC2 <- fviz_pca_ind(DM_pca_FM,
                            geom.ind = "point", # show points only (but not "text"),
                            pointsize = 2.75,
                            pointshape = 21,
                            fill.ind = DM_data.frame$Site, # color by groups
                            col.ind = DM_data.frame$Site,
                            #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                            legend.title = "Site",
                            mean.point = FALSE,  # removes group mean point
                            title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC2
ggsave("pca_PC1_PC2.pdf")

pca_PC1_PC2_mean <- fviz_pca_ind(DM_pca_FM,
                                 geom.ind = "point", # show points only (but not "text"),
                                 pointsize = 2.75,
                                 pointshape = 21,
                                 fill.ind = DM_data.frame$Site, # color by groups
                                 col.ind = DM_data.frame$Site,
                                 #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                 legend.title = "Site",
                                 title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC2_mean
ggsave("pca_PC1_PC2_mean.pdf")

pca_PC2_PC3 <- fviz_pca_ind(DM_pca_FM,
                            axes = c(2,3),
                            geom.ind = "point", # show points only (but not "text"),
                            pointsize = 2.75,
                            pointshape = 21,
                            fill.ind = DM_data.frame$Site, # color by groups
                            col.ind = DM_data.frame$Site,
                            #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                            legend.title = "Site",
                            mean.point = FALSE,  # removes group mean point
                            title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC2_PC3
ggsave("pca_PC2_PC3.pdf")

pca_PC2_PC3_mean <- fviz_pca_ind(DM_pca_FM,
                                 axes = c(2,3),
                                 geom.ind = "point", # show points only (but not "text"),
                                 pointshape = 21,
                                 pointsize = 2.75,
                                 fill.ind = DM_data.frame$Site, # color by groups
                                 col.ind = DM_data.frame$Site,
                                 #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                 legend.title = "Site",
                                 title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC2_PC3_mean

ggsave("pca_PC2_PC3_mean.pdf")

pca_PC1_PC3_mean <- fviz_pca_ind(DM_pca_FM,
                                 axes = c(1,3),
                                 geom.ind = "point", # show points only (but not "text"),
                                 pointshape = 21,
                                 pointsize = 2.75,
                                 fill.ind = DM_data.frame$Site, # color by groups
                                 col.ind = DM_data.frame$Site,
                                 #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                 legend.title = "Site",
                                 title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC3_mean
ggsave("pca_PC1_PC3_mean.pdf")

pca_PC3_PC4_mean <- fviz_pca_ind(DM_pca_FM,
                                 axes = c(3,4),
                                 geom.ind = "point", # show points only (but not "text"),
                                 pointshape = 21,
                                 pointsize = 2.75,
                                 fill.ind = DM_data.frame$Site, # color by groups
                                 col.ind = DM_data.frame$Site,
                                 #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                 legend.title = "Site",
                                 title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC3_PC4_mean
ggsave("pca_PC3_PC4_mean.pdf")

pca_PC4_PC5_mean <- fviz_pca_ind(DM_pca_FM,
                                 axes = c(4,5),
                                 geom.ind = "point", # show points only (but not "text"),
                                 pointshape = 21,
                                 pointsize = 2.75,
                                 fill.ind = DM_data.frame$Site, # color by groups
                                 col.ind = DM_data.frame$Site,
                                 #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                 legend.title = "Site",
                                 title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC4_PC5_mean
ggsave("pca_PC4_PC5_mean.pdf")



#### biplot of individuals and variables ####
fviz_pca_biplot(DM_pca_FM, repel = TRUE,
                col.var = "#2E9FDF",  # variables colour
                col.ind = "#696969"  # individuals colour
)
ind_biplot1<- fviz_pca_biplot(DM_pca_FM, repel = TRUE,
                              col.var = "#2E9FDF",  # variables colour
                              col.ind = "#696969"  # individuals colour
)
ggsave("ind_biplot1.pdf")
#### colour individuals by site ####
fviz_pca_biplot(DM_pca_FM,
                geom.ind = "point",
                label = "var",
                col.ind = DM_data.frame$Site,  # colour by groups
                pointsize = 2.5,
                #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                axes = c(1,2),
                legend.title = "Site",
                col.var = "black",
                repel = TRUE,
                mean.point = FALSE  # removes group mean point
)

ind_biplot_by_site<- fviz_pca_biplot(DM_pca_FM,
                                     geom.ind = "point",
                                     label = "var",
                                     col.ind = DM_data.frame$Site,  # colour by groups
                                     pointsize = 2.5,
                                     #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                     axes = c(1,2),
                                     legend.title = "Site",
                                     col.var = "black",
                                     repel = TRUE,
                                     mean.point = FALSE  # removes group mean point
)

ind_biplot_by_site
ggsave("ind_biplot_by_site")
# colour individuals by Site
fviz_pca_biplot(DM_pca_FM, axes = c(1,2),
                geom.ind = "point",
                col.ind = DM_data.frame$Site,  # colour by groups
                mean.point = FALSE,  # removes group mean point
                pointsize = 2.5,
                #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                label = "var",
                alpha.var ="contrib",col.var = "black",
                repel = TRUE,
                select.var = list(contrib = 30),  # top contributing var
                legend.title = "Site"
)

ind_biplot_by_site_points<- fviz_pca_biplot(DM_pca_FM, axes = c(1,2),
                                            geom.ind = "point",
                                            col.ind = DM_data.frame$Site,  # colour by groups
                                            mean.point = FALSE,  # removes group mean point
                                            pointsize = 2.5,
                                            #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                            label = "var",
                                            alpha.var ="contrib",col.var = "black",
                                            repel = TRUE,
                                            select.var = list(contrib = 30),  # top contributing var
                                            legend.title = "Site"
)

ind_biplot_by_site_points
ggsave("ind_biplot_by_site_points.pdf")
# colour individuals by Site
fviz_pca_biplot(DM_pca_FM, axes = c(2,3),
                geom.ind = "point",
                col.ind = DM_data.frame$Site,  # colour by groups
                mean.point = FALSE,  # removes group mean point
                pointsize = 2.5,
                #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                label = "var",
                alpha.var ="contrib",col.var = "black",
                repel = TRUE,
                select.var = list(contrib = 10),  # top contributing var
                legend.title = "Site"
)
ind_biplot_by_site_points_pc2_3<- fviz_pca_biplot(DM_pca_FM, axes = c(2,3),
                                                  geom.ind = "point",
                                                  col.ind = DM_data.frame$Site,  # colour by groups
                                                  mean.point = FALSE,  # removes group mean point
                                                  pointsize = 2.5,
                                                  #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                                                  label = "var",
                                                  alpha.var ="contrib",col.var = "black",
                                                  repel = TRUE,
                                                  select.var = list(contrib = 10),  # top contributing var
                                                  legend.title = "Site"
)

ind_biplot_by_site_points_pc2_3
ggsave("ind_biplot_by_site_points_pc2_3.pdf")

# colour individuals by Site
fviz_pca_biplot(DM_pca_FM, axes = c(3,4),
                geom.ind = "point",
                col.ind = DM_data.frame$Site,  # colour by groups
                mean.point = FALSE,  # removes group mean point
                pointsize = 2.5,
                #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                label = "var",
                alpha.var ="contrib",col.var = "black",
                repel = TRUE,
                select.var = list(contrib = 10),  # top contributing var
                legend.title = "Site"
)
# colour individuals by Site
fviz_pca_biplot(DM_pca_FM, axes = c(4,5),
                geom.ind = "point",
                col.ind = DM_data.frame$Site,  # colour by groups
                mean.point = FALSE,  # removes group mean point
                pointsize = 2.5,
                #palette = c("#99d8c9", "#08519c","#E7B800", "#FC4E07"),
                label = "var",
                alpha.var ="contrib",col.var = "black",
                repel = TRUE,
                select.var = list(contrib = 10),  # top contributing var
                legend.title = "Site"
)
#### by sex ####
# Color by groups
pca_PC1_PC2_sex <- fviz_pca_ind(DM_pca_FM,
                                geom.ind = "point", # show points only (but not "text"),
                                pointsize = 2.75,
                                pointshape = 21,
                                fill.ind = DM_data.frame$Sex, # color by groups
                                col.ind = DM_data.frame$Sex,
                                palette = c("#99d8c9", "#08519c","#E7B800"),
                                legend.title = "Sex",
                                mean.point = FALSE,  # removes group mean point
                                title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC2_sex

ggsave("pca_PC1_PC2_sex")

pca_PC1_PC2_mean_sex <- fviz_pca_ind(DM_pca_FM,
                                     geom.ind = "point", # show points only (but not "text"),
                                     pointsize = 2.75,
                                     pointshape = 21,
                                     fill.ind = DM_data.frame$Sex, # color by groups
                                     col.ind = DM_data.frame$Sex,
                                     palette = c("#99d8c9", "#08519c","#E7B800"),
                                     legend.title = "Sex",
                                     title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC2_mean_sex
ggsave("pca_PC1_PC2_mean_sex.pdf")

pca_PC3_PC2_mean_sex <- fviz_pca_ind(DM_pca_FM, axes = c(2,3),
                                     geom.ind = "point", # show points only (but not "text"),
                                     pointsize = 2.75,
                                     pointshape = 21,
                                     fill.ind = DM_data.frame$Sex, # color by groups
                                     col.ind = DM_data.frame$Sex,
                                     palette = c("#99d8c9", "#08519c","#E7B800"),
                                     legend.title = "Sex",
                                     title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC3_PC2_mean_sex
ggsave("pca_PC3_PC2_mean_sex")

pca_PC3_PC4_mean_sex <- fviz_pca_ind(DM_pca_FM, axes = c(3,4),
                                     geom.ind = "point", # show points only (but not "text"),
                                     pointsize = 2.75,
                                     pointshape = 21,
                                     fill.ind = DM_data.frame$Sex, # color by groups
                                     col.ind = DM_data.frame$Sex,
                                     palette = c("#99d8c9", "#08519c","#E7B800"),
                                     legend.title = "Sex",
                                     title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC3_PC4_mean_sex

pca_PC4_PC5_mean_sex <- fviz_pca_ind(DM_pca_FM, axes = c(4,5),
                                     geom.ind = "point", # show points only (but not "text"),
                                     pointsize = 2.75,
                                     pointshape = 21,
                                     fill.ind = DM_data.frame$Sex, # color by groups
                                     col.ind = DM_data.frame$Sex,
                                     palette = c("#99d8c9", "#08519c","#E7B800"),
                                     legend.title = "Sex",
                                     title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC4_PC5_mean_sex


#### by year ####
pca_PC1_PC2_year <- fviz_pca_ind(DM_pca_FM,
                                geom.ind = "point", # show points only (but not "text"),
                                pointsize = 2.75,
                                pointshape = 21,
                                fill.ind = DM_data.frame$Year, # color by groups
                                col.ind = DM_data.frame$Year,
                                palette = c("#99d8c9", "#08519c","#E7B800"),
                                legend.title = "Year",
                                mean.point = FALSE,  # removes group mean point
                                title = "") +
  theme(aspect.ratio = 1/1) +
  theme(axis.text = element_text(size = 13, colour = "black"),
        axis.title = element_text(size = 14, face = "bold"))
pca_PC1_PC2_year

is.factor(DM_pca_FM$Year)
as.factor(DM_pca_FM$Year)

fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year,
             geom.ind = "point", # show points only (nbut not "text"),
             pointsize = 2.5,
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             legend.title = "Year")  
ind_year<-fviz_pca_ind(DM_pca_FM, col.ind = DM_data.frame$Year,
                       geom.ind = "point", # show points only (nbut not "text"),
                       pointsize = 2.5,
                       gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
                       legend.title = "Year")   
ind_year
ggsave("ind_year.pdf")

library(patchwork)

#### compound graphs ####
variables_PCA /
  ind_biplot_by_site_points

p1<- variables_PCA /
  ind_biplot_by_site_points
ggsave("p1.pdf")
variables_PCA + ind_biplot_by_site_points
